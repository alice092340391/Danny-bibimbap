<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾Œå°ç®¡ç†ä»‹é¢</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="styles1.css">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8f9fa;
            color: #333;
            margin: 0;
            display: flex;
        }

        .sidebar-logo {
            padding: 18px;
            text-align: center;
            background-color: #9aa0a8;
            font-size: 1.0rem;
            font-weight: bold;
            display: flex; /* ä½¿åœ–åœ–ç‰‡å’Œæ–‡å­—å¹¶æ’ */
            align-items: center; /* å‚ç›´å±…ä¸­ */
            gap: 10px; /* åœ–ç‰‡å’Œæ–‡å­—ä¹‹é–“çš„é–“è· */
        }

        .sidebar-logo img {
            width: 40px; /* å¯¬åº¦ */
            height: auto; /* ä¿æŒæ¯”ä¾‹ */
        }

        .navbar {
            width: 200px;
            background-color: #2c3e50;
            height: 100vh;
            position: fixed;
            padding-top: 3px;
        }

        .navbar a,
        .navbar button {
            text-decoration: none;
            color: #ecf0f1;
            padding: 13px;
            display: block;
            text-align: left;
            font-size: 16px;
            border: none;
            background: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .navbar a i,
        .navbar button i {
            margin-right: 10px;
        }

        .navbar a:hover,
        .navbar button:hover {
            background-color: #34495e;
        }

        .dropdown {
            position: relative;
            margin-bottom: 20px;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            margin-top: 10px;
            min-width: 200px;
            box-shadow: 0px 8px 16px 0px rgba(0, 0, 0, 0.2);
            z-index: 1;
        }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }

        .dropdown[aria-expanded="true"] .dropdown-content {
            display: block;
        }

        .main-content {
            margin-left: 240px;
            padding: 20px;
            flex: 1;
        }

        .dashboard {
            display: none;
        }

        .dashboard.active {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .card {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            text-align: center;
        }

        .card h3 {
            font-size: 20px;
            margin-bottom: 10px;
            color: #007bff;
        }

        .card ul,
        .card table {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .card ul li,
        .card table td {
            padding: 10px;
            border-bottom: 1px solid #ccc;
        }

        .card ul li:last-child,
        .card table td:last-child {
            border-bottom: none;
        }

        .card .menu-item {
            margin-top: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .card .menu-item img {
            display: block;
            margin-bottom: 10px;
            width: 100%;
            height: auto;
            max-width: 250px;
        }

        .card .menu-item h4 {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .card .menu-item p {
            margin-bottom: 5px;
        }

        .card .menu-item button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            width: 100%;
            max-width: 150px;
        }

        .card .menu-item button:hover {
            background-color: #45a049;
        }

        #add-dish {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        #add-dish h2 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        #add-dish-form .form-group {
            margin-bottom: 20px;
        }

        #add-dish-form label {
            font-weight: bold;
            color: #555;
        }

        #add-dish-form input[type="text"],
        #add-dish-form input[type="number"],
        #add-dish-form select,
        #add-dish-form textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        #add-dish-form textarea {
            resize: vertical;
        }

        #add-dish-form .btn-primary {
            background-color: #007bff;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #add-dish-form .btn-primary:hover {
            background-color: #0056b3;
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            margin-right: -5px;
            margin-left: -5px;
        }

        .form-row>.form-group {
            padding-right: 5px;
            padding-left: 5px;
            flex: 1;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
        }

        /* ç¢ºä¿èœå–®å…§å®¹å®¹å™¨å±…ä¸­ */
        #menu-list-content {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            /* å±…ä¸­å°é½Šèœå–® */
            margin: 20px auto;
            /* æ–°å¢å¤–é‚Šè·ä»¥åˆ†éš”å…¶ä»–å…ƒç´  */
            max-width: 1200px;
            /* è¨­å®šæœ€å¤§å¯¬åº¦ä»¥é˜²å…§å®¹éå¯¬ */
        }

        /* é¸å–®é …ç›®å¡ç‰‡æ¨£å¼ */
        .card {
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin: 10px;
            padding: 15px;
            width: 300px;
            /* å¯ä»¥æ ¹æ“šéœ€è¦èª¿æ•´å¯¬åº¦ */
            text-align: center;
        }

        /* å…¶ä»–å…ƒç´ æ¨£å¼ */
        button {
            margin: 10px;
            /* æ–°å¢å¤–é‚Šè·ä»¥åˆ†éš”å…¶ä»–å…ƒç´  */
        }

        /* é¿å…é¸å–®å…§å®¹èˆ‡å…¶ä»–æ§åˆ¶é …é‡ç–Š */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            font-family: Arial, sans-serif;
        }

        .dashboard {
            padding: 20px;
            font-family: Arial, sans-serif;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: #f4f4f4;
        }

        tr:hover {
            background-color: #f9f9f9;
        }
        img {
            max-width: 100px;
            max-height: 100px;
        }

        .employee-info {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-top: auto;
            /* å°‡å…¶æ¨åˆ°åº•éƒ¨ */
            background-color: #576558;
            color: white;
        }

        .employee-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
        }

        .employee-info span {
            font-size: 14px;
        }

        .navbar a.btn.btn-danger {
            margin-bottom: 10px;
        }

        /* é»˜èªæ·ºè‰²ä¸»é¡Œ */
        body {
            background-color: white;
            color: black;
        }

        /* æ·±è‰²ä¸»é¡Œ */
        .dark-theme {
            background-color: black;
            color: white;
        }

        #logged-in-user-info {
            position: fixed;
            bottom: 10px;
            left: 10px;
            /* å°†leftæ”¹ä¸ºright */
            background-color: #7e87cb;
            color: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.3);
            font-size: 14px;
            display: flex;
            align-items: center;
        }


        #employee-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
        }

        #employee-name {
            font-size: 14px;
        }

        #category-management {
            padding: 20px;
            background-color: #f5f5f5;
            border-radius: 8px;
        }

        .category-actions,
        .category-list,
        .category-details,
        .delete-category {
            margin-bottom: 20px;
        }

        /* Input fields */
        input[type="text"],
        input[type="number"] {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        button {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .btn-primary {
            background-color: #007bff;
            color: white;
        }

        .btn-success {
            background-color: #28a745;
            color: white;
        }

        .btn-danger {
            background-color: #dc3545;
            color: white;
        }

        #category-list {
            list-style-type: none;
            padding: 0;
        }

        #category-list li {
            background-color: white;
            margin-bottom: 5px;
            padding: 10px;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #category-details-content {
            background-color: white;
            padding: 15px;
            border-radius: 4px;
        }

        .inventory .panel {
            width: 100%;
        }

        @media (max-width: 600px) {
        .main-content {
            margin-left: 0;
            padding: 5px;
        }
        table {
            display: block;
            width: 100%;
            overflow-x: auto;
            white-space: nowrap;
        }
        th, td {
            font-size: 12px;
            padding: 6px;
        }
        .navbar {
            width: 100vw;
            position: static;
            height: auto;
        }
    }
    </style>
</head>

<body>

    <div class="navbar">
        <div class="sidebar-logo">
            <img src="logle.jpg" alt="ä¸¹å°¼å¤å¨å¤· Logo">
            <span>ä¸¹å°¼å¤å¨å¤·</span>
        </div>
        <button id="homeButton"><i class="fas fa-home"></i>é¦–é </button>
        <script>
            if (!localStorage.getItem('lastVisitedPage')) {
                localStorage.setItem('lastVisitedPage', window.location.href);
            }

            document.getElementById('homeButton').addEventListener('click', function () {
                var lastVisitedPage = localStorage.getItem('lastVisitedPage');

                // Validate lastVisitedPage URL
                if (lastVisitedPage && lastVisitedPage !== 'null' && lastVisitedPage !== 'undefined') {
                    window.location.href = lastVisitedPage;
                }
                else {
                    // Provide a fallback URL
                    window.location.href = '/home';  // Change this to your actual home URL
                }
            });
        </script>
        <div class="dropdown">
            <button aria-haspopup="true" aria-expanded="false" onclick="toggleDropdown('menu-dropdown')">
                <i class="fas fa-utensils"></i> èœå–®ç®¡ç†
            </button>
            <div id="menu-dropdown" class="dropdown-content">
                <a href="#add-dish">æ–°å¢èœå“</a>
                <a href="#menu-list">èœå–®åˆ—è¡¨</a>
                <a href="#category-management">é¡åˆ¥ç®¡ç†</a>
                <a href="#inventory-management">åº«å­˜ç®¡ç†</a>
            </div>
        </div>
        <div class="dropdown">
            <button aria-haspopup="true" aria-expanded="false" onclick="toggleDropdown('customer-dropdown')">
                <i class="fas fa-users"></i> å®¢æˆ¶ç®¡ç†
            </button>
            <div id="customer-dropdown" class="dropdown-content">
                <a href="#customer-list">å®¢æˆ¶åˆ—è¡¨</a>
                <!--<a href="#feedback">è©•åƒ¹èˆ‡åé¥‹</a>-->
            </div>
        </div>
        <div class="dropdown">
            <button aria-haspopup="true" aria-expanded="false" onclick="toggleDropdown('employee-dropdown')">
                <i class="fas fa-user-tie"></i> å“¡å·¥ç®¡ç†
            </button>
            <div id="employee-dropdown" class="dropdown-content">
                <a href="#employee-list">å“¡å·¥åˆ—è¡¨</a>
                <!--<a href="#add-employee">æ–°å¢å“¡å·¥</a>-->
                <!--<a href="#schedule-management">æ’ç­ç®¡ç†</a>-->
            </div>
        </div>
        <div class="dropdown">
            <button aria-haspopup="true" aria-expanded="false" onclick="toggleDropdown('reports-dropdown')">
                <i class="fas fa-chart-bar"></i> å ±è¡¨èˆ‡åˆ†æ
            </button>
            <div id="reports-dropdown" class="dropdown-content">
                <a href="#sales-report">éŠ·å”®å ±è¡¨</a>
                <a href="inventory.html">åº«å­˜å ±è¡¨</a>
                <a href="#customer-analysis">å®¢æˆ¶åˆ†æ</a>
                <!--<a href="#employee-performance">å“¡å·¥ç¸¾æ•ˆ</a>-->
            </div>
        </div>

        
        
        <div class="dropdown">
            <button aria-haspopup="true" aria-expanded="false" onclick="showOrderManagement()">
                <i class="fas fa-receipt"></i> è¨‚å–®ç®¡ç†
            </button>
        </div>
        <script>
            document.getElementById('homeButton').addEventListener('click', function () {
                var lastVisitedPage = localStorage.getItem('lastVisitedPage');

                if (lastVisitedPage && lastVisitedPage !== 'null' && lastVisitedPage !== 'undefined') {
                    window.location.href = lastVisitedPage;
                } else {
                    window.location.href = '/home';  // Change this to your actual home URL
                }
            });
            document.getElementById('settingsButton').addEventListener('click', function () {
                window.location.href = '#basic-settings';
            });
        </script>
        <!-- å“¡å·¥ä¿¡æ¯å€ -->
        <div class="employee-info" id="logged-in-user-info">
            <img id="employee-avatar" src="cat.png" alt="å“¡å·¥é ­åƒ">
            <span id="employee-name-info">è¼‰å…¥ä¸­...</span>
        </div>

        <!-- ç™»å‡ºæŒ‰é’® -->
        <a href="logout.php" class="btn btn-danger">
            <i class="fas fa-sign-out-alt"></i> ç™»å‡º
        </a>
    </div>

    <div class="main-content">
        <div id="home" class="dashboard active">
            <div class="card">
                <h3>ä»Šæ—¥è¨‚å–®æ•¸é‡</h3>
                <p>150</p>
            </div>
            <div class="card">
                <h3>ä»Šæ—¥éŠ·å”®é¡</h3>
                <p>NT$ 45,000</p>
            </div>
            <div class="card">
                <h3>æ–°å¢å®¢æˆ¶æ•¸</h3>
                <p>5</p>
            </div>
            <div class="card">
                <h3>å¾…è™•ç†è¨‚å–®</h3>
                <p>8</p>
            </div>
            <div class="card">
                <h3>éŠ·å”®è¶¨å‹¢</h3>
                <canvas id="salesTrend"></canvas>
            </div>
            <div class="card">
                <h3>åº«å­˜æ°´å¹³</h3>
                <canvas id="inventoryLevels"></canvas>
            </div>
            <div class="card">
                <h3>æœ€æ–°è¨‚å–®</h3>
                <ul>
                    <li>è¨‚å–® #12345 - 2 åˆ†é˜å‰</li>
                    <li>è¨‚å–® #12344 - 10 åˆ†é˜å‰</li>
                    <li>è¨‚å–® #12343 - 20 åˆ†é˜å‰</li>
                </ul>
            </div>
            <div class="card">
                <h3>ç³»çµ±é€šçŸ¥</h3>
                <p>ç³»çµ±å°‡æ–¼ä»Šæ™š 12:00 é€²è¡Œç¶­è­·ï¼Œé è¨ˆ 2 å°æ™‚ã€‚</p>
            </div>
        </div>
        <div id="add-dish" class="dashboard">
            <h3>æ–°å¢èœå“</h3>
            <form action="add_dish.php" method="POST" enctype="multipart/form-data">

                <!-- ğŸ± åŸºæœ¬è³‡è¨Š -->
                <label for="dish-id">èœå“ç·¨è™Ÿï¼š</label>
                <input type="text" id="dish-id" name="dish-id" placeholder="è‡ªå‹•ç”Ÿæˆæˆ–æ‰‹å‹•è¼¸å…¥" readonly><br><br>

                <label for="dish-name">èœå“åç¨±ï¼š</label>
                <input type="text" id="dish-name" name="dish-name" required placeholder="ä¾‹å¦‚ï¼šè±ªè¯æ³¢å¥‡"><br><br>

                <label for="description">æè¿°ï¼š</label><br>
                <textarea id="description" name="description" rows="3" placeholder="ä¸»è¦é¢¨å‘³ã€ç‰¹è‰²å’Œè³£é»"></textarea><br><br>

                <label for="price">åƒ¹æ ¼ï¼š</label>
                <input type="number" id="price" name="price" step="0.01" required placeholder="ä¾‹å¦‚ï¼š360"><br><br>

                <label for="category">é¡åˆ¥ï¼š</label>
                <select id="category" name="category" required multiple>
                <option value="main-dish">ä¸»èœ</option>
                <option value="side-dish">å‰¯èœ</option>
                <option value="soup">æ¹¯å“</option>
                </select><br><br>

                <label for="dish-image">ä¸Šå‚³åœ–ç‰‡ï¼š</label>
                <input type="file" id="dish-image" name="dish-image" accept="image/*" onchange="showPreview(event);" required><br><br>
                <img id="image-preview" src="#" alt="é è¦½åœ–ç‰‡" style="display: none; width: 100%; max-width: 250px;"><br><br>

                <!-- ğŸ¥— ç‡Ÿé¤Šèˆ‡æˆåˆ† -->
                <label for="calories">ç†±é‡ï¼š</label>
                <input type="number" id="calories" name="calories" step="0.1" placeholder="æ¯ä»½ç†±é‡ï¼ˆå¤§å¡ï¼‰"><br><br>

                <label for="serving-size">ä»½é‡ï¼š</label>
                <input type="text" id="serving-size" name="serving-size" placeholder="ä¾‹å¦‚ï¼š300g"><br><br>

                <label for="ingredients">åŸæ–™å’Œé…æ–™ï¼š</label><br>
                <textarea id="ingredients" name="ingredients" rows="3" placeholder="ä¸»è¦åŸæ–™èˆ‡é…æ–™ï¼ˆå¦‚é®­é­šã€è—œéº¥ã€ç‰›æ²¹æœç­‰ï¼‰"></textarea><br><br>

                <label for="main-ingredients">ä¸»æˆåˆ†åˆ†é¡ï¼š</label>
                <select id="main-ingredients" name="main-ingredients">
                <option value="meat">è‚‰é¡</option>
                <option value="vegetable">èœé¡</option>
                <option value="grain">ç©€ç‰©</option>
                <option value="dairy">ä¹³è£½å“</option>
                <option value="other">å…¶ä»–</option>
                </select><br><br>

                <label for="nutritional-info">ç‡Ÿé¤Šè³‡è¨Šï¼š</label><br>
                <textarea id="nutritional-info" name="nutritional-info" rows="3" placeholder="è›‹ç™½è³ªã€è„‚è‚ªã€ç¢³æ°´åŒ–åˆç‰©ç­‰"></textarea><br><br>

                <!-- ğŸ‘¥ å…¶ä»–è³‡è¨Š -->
                <label for="suitable-for">é©åˆäººç¾¤ï¼š</label><br>
                <textarea id="suitable-for" name="suitable-for" rows="2" placeholder="ä¾‹å¦‚ï¼šå¥èº«æ—ç¾¤ã€ç´ é£Ÿè€…ç­‰"></textarea><br><br>

                <label for="taste-description">å£æ„Ÿæè¿°ï¼š</label><br>
                <textarea id="taste-description" name="taste-description" rows="2" placeholder="æ¸…çˆ½ã€é…¥è„†ã€æ¿ƒéƒç­‰å£æ„Ÿæè¿°"></textarea><br><br>

                <label for="supplier">ä¾›æ‡‰å•†ä¿¡æ¯ï¼š</label>
                <input type="text" id="supplier" name="supplier" placeholder="ä¾›æ‡‰å•†åç¨±æˆ–ä¾†æºåœ°"><br><br>

                <label for="allergens-list">éæ•åŸåˆ—è¡¨ï¼š</label>
                <select id="allergens-list" name="allergens-list" multiple>
                <option value="peanuts">èŠ±ç”Ÿ</option>
                <option value="dairy">ä¹³è£½å“</option>
                <option value="gluten">éº©è³ª</option>
                </select><br><br>

                <label for="dish-status">èœå“ç‹€æ…‹ï¼š</label>
                <select id="dish-status" name="dish-status">
                <option value="available">ä¸Šæ¶</option>
                <option value="unavailable">ä¸‹æ¶</option>
                </select><br><br>

                <label for="discount">æŠ˜æ‰£ï¼š</label>
                <input type="text" id="discount" name="discount" placeholder="å¦‚ 10% / è²·ä¸€é€ä¸€"><br><br>

                <label for="notes">å‚™è¨»ï¼š</label><br>
                <textarea id="notes" name="notes" rows="2" placeholder="å…¶ä»–å‚™è¨»èªªæ˜"></textarea><br><br>

                <button type="submit">æ–°å¢</button>
            </form>
            </div>

            <script>
            function showPreview(event) {
            const imagePreview = document.getElementById('image-preview');
            const file = event.target.files[0];
            if (file) {
                imagePreview.src = URL.createObjectURL(file);
                imagePreview.style.display = 'block';
            }
            }
            </script>


        <div id="menu-list" class="dashboard">
            <h3>èœå–®åˆ—è¡¨</h3>

            <!-- æœå°‹å’Œä¿®æ”¹èœå–®å€å¡Šçš„æ°´å¹³æ’åˆ—å®¹å™¨ -->
            <div id="menu-actions" style="display: flex; justify-content: space-between; gap: 20px; align-items: flex-start;">
                <!-- æœå°‹ -->
                <div id="search-section" style="width: 45%;">
                    <input type="text" id="search-input" placeholder="æœå°‹èœå–®é …ç›®">
                    <button id="search-button">æœå°‹</button>
                </div>

                <!-- ç·¨è¼¯èœå–® -->
                <div id="update-menu-section" style="width: 45%;">
                    <h3>ç·¨è¼¯èœå–®é …ç›®</h3>
                    <input type="number" id="update-menu-id" placeholder="èœå–® ID">
                    <input type="text" id="update-menu-name" placeholder="æ–°èœå–®åç¨±">
                    <input type="number" id="update-menu-price" placeholder="æ–°åƒ¹æ ¼">
                    <button id="update-button">ç·¨è¼¯èœå–®</button>
                </div>
                
                <div id="update-drink-section" style="width: 45%;">
                    <h3>ç·¨è¼¯é£²æ–™é …ç›®</h3>
                    <input type="number" id="update-drink-id" placeholder="é£²æ–™ ID">
                    <input type="text" id="update-drink-name" placeholder="æ–°é£²æ–™åç¨±">
                    <input type="number" id="update-drink-price" placeholder="æ–°åƒ¹æ ¼">
                    <button id="update-drink-button">ç·¨è¼¯é£²æ–™</button>
                </div>
            </div>

                <!-- é¡¯ç¤ºèœå–®åˆ—è¡¨ - èœå–®é …ç›®å°‡é¡¯ç¤ºåœ¨é€™è£¡ -->
                <div id="menu-list-content" style="margin-top: 20px;">
                    <!-- èœå–®é …ç›®å°‡é¡¯ç¤ºåœ¨é€™è£¡ -->
                </div>

        </div>

        <div id="category-management" class="dashboard">
            <h3>é¡åˆ¥ç®¡ç†</h3>
            <form id="add-category-form">
                <label for="category-name">é¡åˆ¥åç¨±ï¼š</label>
                <input type="text" id="category-name" name="category-name" required><br><br>
                <input type="submit" value="æ–°å¢é¡åˆ¥">
            </form>
            <h4>ç¾æœ‰é¡åˆ¥ï¼š</h4>
            <ul id="category-list">
                <!-- é¡åˆ¥å°‡åœ¨æ­¤å‹•æ…‹åŠ è¼‰ -->
            </ul>

            <!-- ç”¨æ–¼ç·¨è¼¯å’Œåˆªé™¤é¡åˆ¥çš„éƒ¨åˆ† -->
            <div id="edit-category">
                <h4>ç·¨è¼¯é¡åˆ¥</h4>
                <form id="edit-category-form">
                    <label for="edit-category-name">é¸æ“‡é¡åˆ¥ï¼š</label>
                    <select id="edit-category-select" name="edit-category-select">
                        <!-- ç·¨è¼¯é¡åˆ¥çš„é¸é …å°‡åœ¨æ­¤å‹•æ…‹åŠ è¼‰ -->
                    </select><br><br>
                    <label for="new-category-name">æ–°é¡åˆ¥åç¨±ï¼š</label>
                    <input type="text" id="new-category-name" name="new-category-name" required><br><br>
                    <input type="submit" value="æ›´æ–°é¡åˆ¥">
                </form>
            </div>

            <div id="delete-category">
                <h4>åˆªé™¤é¡åˆ¥</h4>
                <form id="delete-category-form">
                    <label for="delete-category-select">é¸æ“‡é¡åˆ¥ï¼š</label>
                    <select id="delete-category-select" name="delete-category-select">
                        <!-- åˆªé™¤é¡åˆ¥çš„é¸é …å°‡åœ¨æ­¤å‹•æ…‹åŠ è¼‰ -->
                    </select><br><br>
                    <input type="submit" value="åˆªé™¤é¡åˆ¥">
                </form>
            </div>
        </div>


        <div id="inventory-management" class="dashboard inventory">
            <h3>åº«å­˜ç®¡ç†</h3>
            <div class="panel">
                <form id="inventory-form">
                    <label for="inventory-item">åº«å­˜é …ç›®ï¼š</label>
                    <input type="text" id="inventory-item" name="inventory-item" required><br><br>
                    <label for="inventory-quantity">æ•¸é‡ï¼š</label>
                    <input type="number" id="inventory-quantity" name="inventory-quantity" required><br><br>
                    <input type="submit" value="æ–°å¢åº«å­˜">
                </form>
            </div>
            <div class="panel">
                <h4>ç¾æœ‰åº«å­˜ï¼š</h4>
                <label for="search-item">æœå°‹åº«å­˜ï¼š</label>
                <input type="text" id="search-item" placeholder="è¼¸å…¥é …ç›®åç¨±">
                <button onclick="searchInventory()">æœå°‹</button>
                <button onclick="exportInventory()">å°å‡ºåº«å­˜</button>
                <input type="file" id="import-file" accept=".csv" onchange="importInventory(event)">
                <button onclick="deleteSelectedItems()">æ‰¹é‡åˆªé™¤é¸ä¸­é …ç›®</button>
                <table>
                    <thead>
                        <tr>
                            <th>é¸æ“‡</th>
                            <th>é …ç›®</th>
                            <th>æ•¸é‡</th>
                            <th>ç‹€æ…‹</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- åº«å­˜è¡Œæœƒç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>
        </div>

        <div id="customer-list" class="dashboard">
            <div id="search-bar">
                <h2>å®¢æˆ¶åˆ—è¡¨</h2>
                <input type="text" id="search-customer-input" placeholder="æœå°‹å®¢æˆ¶..." onkeyup="searchCustomers()">
                <!-- å»ºè­°æ”¾åœ¨ #search-bar å…§ï¼Œ#search-customer-input ä¸‹æ–¹ -->
                <input type="date" id="search-customer-start" placeholder="é–‹å§‹æ—¥æœŸ">
                <input type="date" id="search-customer-end" placeholder="çµæŸæ—¥æœŸ">
                <button onclick="advancedCustomerSearch()">é€²éšæœå°‹</button>
                <div id="no-results" style="display: none;">æ²’æœ‰æ•¸æ“š</div>
                <input type="date" id="date-filter" onchange="filterTable()"/>
                <button id="add-customer-btn">æ–°å¢å®¢æˆ¶</button>
                <!-- æ–°å¢åˆ†é æ§åˆ¶å€ -->
                <div id="customer-pagination" style="margin: 10px 0; text-align: right;">
                    <button onclick="changeCustomerPage(-1)" id="customer-prev-btn">ä¸Šä¸€é </button>
                    <span id="customer-page-info"></span>
                    <button onclick="changeCustomerPage(1)" id="customer-next-btn">ä¸‹ä¸€é </button>
                </div>
            </div>
            <!-- æ·»åŠ å®¢æˆ¶æ¨¡å¼ -->
            <div id="add-customer-modal" style="display: none;">
                <div>
                    <h2>æ–°å¢å®¢æˆ¶</h2>
                    <form id="add-customer-form">
                        <label for="customer-name">å§“å:</label>
                        <input type="text" id="customer-name" required>
                        <label for="customer-phone">é›»è©±:</label>
                        <input type="text" id="customer-phone" required>
                        <label for="customer-email">éƒµç®±:</label>
                        <input type="email" id="customer-email" required>
                        <label for="customer-date">è¨»å†Šæ—¥æœŸ:</label>
                        <input type="date" id="customer-date" required>
                        <button type="submit">æäº¤</button>
                        <button type="button" onclick="hideAddCustomerModal()">å–æ¶ˆ</button>
                    </form>
                </div>
            </div>
            <!-- Edit Customer Modal (å¯é¸) -->
            <div id="edit-customer-modal" style="display: none;">
                <div>
                    <h2>ç·¨è¼¯å®¢æˆ¶</h2>
                    <form id="edit-customer-form">
                        <input type="hidden" id="edit-customer-id">
                        <label for="edit-customer-name">å§“å:</label>
                        <input type="text" id="edit-customer-name" required>
                        <label for="edit-customer-phone">é›»è©±:</label>
                        <input type="text" id="edit-customer-phone" required>
                        <label for="edit-customer-email">éƒµç®±:</label>
                        <input type="email" id="edit-customer-email" required>
                        <label for="edit-customer-date">è¨»å†Šæ—¥æœŸ:</label>
                        <input type="date" id="edit-customer-date" required>
                        <button type="submit">ä¿å­˜</button>
                        <button type="button" onclick="hideEditCustomerModal()">å–æ¶ˆ</button>
                    </form>
                </div>
            </div>
            <table>
                <thead>
                    <tr>
                        <th onclick="sortTable(0, 'string')">å®¢æˆ¶ç·¨è™Ÿ</th>
                        <th onclick="sortTable(1, 'string')">å®¢æˆ¶å§“å</th>
                        <th onclick="sortTable(2, 'string')">é›»è©±è™Ÿç¢¼</th>
                        <th onclick="sortTable(3, 'string')">éƒµç®±</th>
                        <th onclick="sortTable(4, 'date')">è¨»å†Šæ—¥æœŸ</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="customer-tbody">
                    <!-- è³‡æ–™å°‡å‹•æ…‹å¡«å…¥æ­¤è™• -->
                </tbody>
            </table>
            <div id="no-results" style="display: none;">æ²’æœ‰æ•¸æ“š</div>
            <div id="loading" style="display: none;">Loading...</div>
        </div>

        <div id="feedback" class="dashboard">
            <h3>è©•åƒ¹èˆ‡åé¥‹</h3>
            <form>
                <label for="customer-name">å®¢æˆ¶å§“åï¼š</label>
                <input type="text" id="customer-name" name="customer-name" required><br><br>
                <label for="feedback">åé¥‹å…§å®¹ï¼š</label><br>
                <textarea id="feedback" name="feedback" rows="4" required></textarea><br><br>
                <input type="submit" value="æäº¤åé¥‹">
            </form>
            <h4>æœ€æ–°åé¥‹ï¼š</h4>
            <ul>
                <li>é¡§å®¢A:æœå‹™å¾ˆå¥½ï¼Œèœå“ä¹Ÿå¾ˆç¾å‘³ã€‚</li>
                <li>é¡§å®¢B:é¤å»³ç’°å¢ƒèˆ’é©ï¼Œä½†æœå‹™ç¨æ…¢ã€‚</li>
                <!-- æ·»åŠ æ›´å¤šåé¥‹ä¿¡æ¯ -->
                </ul>
        </div>
        <div id="employee-list" class="dashboard">
            <!-- æ–°å¢å“¡å·¥ -->
            <h3>æ–°å¢å“¡å·¥</h3>
            <form id="employee-form" onsubmit="return submitEmployeeForm();" method="POST">
                <label for="employee-name">å“¡å·¥å§“åï¼š</label>
                <input type="text" id="employee-name" name="employee-name" required minlength="2" placeholder="è«‹è¼¸å…¥å“¡å·¥å§“å">
                <span id="name-error" class="error"></span>

                <label for="employee-gender">æ€§åˆ«ï¼š</label>
                <input type="text" id="employee-gender" name="employee-gender" required minlength="1"
                    placeholder="è«‹è¼¸å…¥æ€§åˆ«">
                <span id="gender-error" class="error"></span>

                <label for="employee-position">è·ä½ï¼š</label>
                <input type="text" id="employee-position" name="employee-position" required minlength="2"
                    placeholder="è«‹è¼¸å…¥è·ä½">
                <span id="position-error" class="error"></span>

                <label for="employee-phone">é›»è©±è™Ÿç¢¼ï¼š</label>
                <input type="tel" id="employee-phone" name="employee-phone" required pattern="[0-9]{10}"
                    placeholder="è«‹è¼¸å…¥10ä½é›»è©±è™Ÿç¢¼">
                <span id="phone-error" class="error"></span>

                <label for="employee-email">éƒµç®±ï¼š</label>
                <input type="email" id="employee-email" name="employee-email" required placeholder="è«‹è¼¸å…¥æœ‰æ•ˆçš„éƒµç®±åœ°å€">
                <span id="email-error" class="error"></span>

                <input type="submit" value="æ–°å¢å“¡å·¥">
            </form>
            <h3>å“¡å·¥åˆ—è¡¨</h3>
            <input type="text" id="searchInput" placeholder="æœå°‹å“¡å·¥..." onkeyup="searchStaff()">
            <!-- åˆ†é æ§åˆ¶å€ -->
            <div id="staff-pagination" style="margin: 10px 0; text-align: right;">
                <button onclick="changeStaffPage(-1)" id="staff-prev-btn">ä¸Šä¸€é </button>
                <span id="staff-page-info"></span>
                <button onclick="changeStaffPage(1)" id="staff-next-btn">ä¸‹ä¸€é </button>
            </div>
            <!-- ç·¨è¼¯è¡¨å–®çš„æ¨¡æ…‹æ¡† -->
            <div id="editModal" style="display: none;">
                <form id="editForm">
                    <label for="editName">å§“å:</label>
                    <input type="text" id="editName" name="name">
                    <label for="editGender">æ€§åˆ«:</label>
                    <input type="text" id="editGender" name="gender">
                    <label for="editPosition">è·ä½:</label>
                    <input type="text" id="editPosition" name="position">
                    <label for="editPhone">é›»è©±:</label>
                    <input type="text" id="editPhone" name="phone">
                    <label for="editEmail">éƒµç®±:</label>
                    <input type="text" id="editEmail" name="email">
                    <input type="hidden" id="editId" name="id">
                    <button type="button" onclick="submitEdit()">ä¿å­˜</button>
                    <button type="button" onclick="closeEditModal()">å–æ¶ˆ</button>
                </form>
            </div>
            <p>
            <table id="staffTable">
                <thead>
                    <tr>
                        <th>å“¡å·¥ç·¨è™Ÿ</th>
                        <th>å§“å</th>
                        <th>æ€§åˆ¥</th> <!-- æ·»åŠ æ€§åˆ«åˆ— -->
                        <th>è·ä½</th>
                        <th>é›»è©±</th>
                        <th>éƒµç®±</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- å‹•æ…‹è³‡æ–™å¡«å…… -->
                </tbody>
            </table>
            </p>
        </div>


        <!--<div id="add-employee" class="dashboard">
            <h3>æ–°å¢å“¡å·¥</h3>
            <form id="employee-form">
                <label for="employee-name">å“¡å·¥å§“åï¼š</label>
                <input type="text" id="employee-name" name="employee-name" required minlength="2" placeholder="è«‹è¼¸å…¥å“¡å·¥å§“å">
                <span id="name-error" class="error"></span>
    
                <label for="employee-position">è·ä½ï¼š</label>
                <input type="text" id="employee-position" name="employee-position" required minlength="2" placeholder="è«‹è¼¸å…¥è·ä½">
                <span id="position-error" class="error"></span>
    
                <label for="employee-email">éƒµç®±ï¼š</label>
                <input type="email" id="employee-email" name="employee-email" required placeholder="è«‹è¼¸å…¥æœ‰æ•ˆçš„éƒµç®±åœ°å€">
                <span id="email-error" class="error"></span>
    
                <label for="employee-phone">é›»è©±è™Ÿç¢¼ï¼š</label>
                <input type="tel" id="employee-phone" name="employee-phone" required pattern="[0-9]{10}" placeholder="è«‹è¼¸å…¥10ä½é›»è©±è™Ÿç¢¼">
                <span id="phone-error" class="error"></span>
    
                <label for="employee-department">éƒ¨é–€ï¼š</label>
                <select id="employee-department" name="employee-department" required>
                    <option value="">è«‹é¸æ“‡éƒ¨é–€</option>
                    <option value="hr">äººåŠ›è³‡æºéƒ¨</option>
                    <option value="it">è³‡è¨ŠæŠ€è¡“éƒ¨</option>
                    <option value="sales">éŠ·å”®éƒ¨</option>
                    <option value="finance">è²¡å‹™éƒ¨</option>
                </select>
    
                <label for="employee-level">ç­‰ç´šï¼š</label>
                <select id="employee-level" name="employee-level" required>
                    <option value="">è«‹é¸æ“‡ç­‰ç´š</option>
                    <option value="junior">åˆç´š</option>
                    <option value="mid">ä¸­ç´š</option>
                    <option value="senior">é«˜ç´š</option>
                </select>
    
                <label for="employee-photo">ä¸Šå‚³ç…§ç‰‡ï¼š</label>
                <input type="file" id="employee-photo" name="employee-photo" accept="image/*">
    
                <label for="employee-start-date">å…¥è·æ—¥æœŸï¼š</label>
                <input type="date" id="employee-start-date" name="employee-start-date" required>
    
                <input type="submit" value="æ–°å¢å“¡å·¥">
            </form>
        </div>-->

        <div id="schedule-management" class="dashboard">
            <h3>æ’ç­ç®¡ç†</h3>
            <p>
            <form id="schedule-form">
                <label for="employee-name">è¼¸å…¥å§“åï¼š</label>
                <input type="text" id="employee-name" name="employee-name" required><br><br>
                <label for="shift-date">æ—¥æœŸï¼š</label>
                <input type="date" id="shift-date" name="shift-date" required><br><br>
                <label for="shift-time">æ™‚é–“ï¼š</label>
                <input type="time" id="shift-time" name="shift-time" required><br><br>
                <label for="shift-duration">æŒçºŒæ™‚é–“ï¼ˆå°æ™‚ï¼‰ï¼š</label>
                <input type="number" id="shift-duration" name="shift-duration" min="1" required><br><br>
                <input type="submit" value="æ’ç­">
            </form>
            </p>

            <!-- æ’ç­åˆ—è¡¨ -->
            <h3>æ’ç­åˆ—è¡¨</h3>
            <table id="schedule-table" border="1">
                <thead>
                    <tr>
                        <th>å“¡å·¥å§“å</th>
                        <th>æ—¥æœŸ</th>
                        <th>æ™‚é–“</th>
                        <th>æŒçºŒæ™‚é–“ï¼ˆå°æ™‚ï¼‰</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- é€™è£¡æœƒæ’å…¥æ’ç­çš„æ•¸æ“š -->
                </tbody>
            </table>
        </div>

        <div id="sales-report" class="dashboard">
            <h3>éŠ·å”®å ±è¡¨</h3>

            <!-- æ—¥æœŸç¯„åœ -->
            <div>
                <label for="timePeriodFilter">æ—¥æœŸç¯„åœ:</label>
                <select id="timePeriodFilter">
                    <option value="monthly">æ¯æœˆ</option>
                    <option value="quarterly">æ¯å­£åº¦</option>
                    <option value="yearly">æ¯å¹´</option>
                </select>
            </div>

            <!-- éŠ·å”®æ•¸æ“š -->
            <div>
                <h4>éŠ·å”®æ•¸æ“š</h4>
                <p>éŠ·å”®é¡ã€éŠ·å”®é‡ã€å–®åƒ¹æŒ‰åˆ†é¡çµ±è¨ˆï¼š</p>
                <canvas id="salesDataChart"></canvas>
            </div>

            <!-- æˆæœ¬å’Œåˆ©æ½¤ -->
            <div>
                <h4>æˆæœ¬å’Œåˆ©æ½¤</h4>
                <p>åŒ…æ‹¬éŠ·å”®æˆæœ¬ã€æ¯›åˆ©å’Œæ·¨åˆ©æ¶¦ï¼š</p>
                <canvas id="costProfitChart"></canvas>
            </div>

            <!-- éŠ·å”®è¶¨å‹¢åˆ†æ -->
            <div>
                <h4>éŠ·å”®è¶¨å‹¢åˆ†æ</h4>
                <p>éŠ·å”®æ•¸æ“šçš„è¶¨å‹¢è®ŠåŒ–ï¼š</p>
                <canvas id="salesTrendChart"></canvas>
            </div>

            <!-- å®¢æˆ¶åˆ†æ -->
            <div>
                <h4>å®¢æˆ¶åˆ†æ</h4>
                <p>æ–°å®¢æˆ¶å’Œç¾æœ‰å®¢æˆ¶çš„éŠ·å”®æƒ…æ³ï¼š</p>
                <canvas id="customerAnalysisChart"></canvas>
            </div>

            <!-- åœ°å€æˆ–å¸‚å ´åˆ†æ -->
            <div>
                <h4>åœ°å€æˆ–å¸‚å ´åˆ†æ</h4>
                <p>å„åœ°å€æˆ–å¸‚å ´çš„éŠ·å”®è¡¨ç¾ï¼š</p>
                <canvas id="regionalMarketChart"></canvas>
            </div>

            <!-- ç”¢å“æˆ–æœå‹™åˆ†æ -->
            <div>
                <h4>ç”¢å“æˆ–æœå‹™åˆ†æ</h4>
                <p>ä¸åŒç”¢å“æˆ–æœå‹™çš„éŠ·å”®é¡å’ŒéŠ·å”®é‡ï¼š</p>
                <canvas id="productServiceChart"></canvas>
            </div>

            <!-- éŠ·å”®æ¸ é“åˆ†æ -->
            <div>
                <h4>éŠ·å”®æ¸ é“åˆ†æ</h4>
                <p>å„éŠ·å”®æ¸ é“çš„è²¢ç»ï¼š</p>
                <canvas id="salesChannelChart"></canvas>
            </div>

            <!-- éŠ·å”®äººå“¡ç¸¾æ•ˆ -->
            <div>
                <h4>éŠ·å”®äººå“¡ç¸¾æ•ˆ</h4>
                <p>å„éŠ·å”®äººå“¡çš„éŠ·å”®è¡¨ç¾ï¼š</p>
                <canvas id="salesPerformanceChart"></canvas>
            </div>

            <!-- åœ–è¡¨å·¥å…·æç¤º -->
            <div id="tooltip" style="display: none;"></div>
        </div>

        <div id="customer-analysis" class="dashboard">
            <h3>å®¢æˆ¶åˆ†æ</h3>
            <div class="date-range">
                <label for="start-date">é–‹å§‹æ—¥æœŸ:</label>
                <input type="date" id="start-date">
                <label for="end-date">çµæŸæ—¥æœŸ:</label>
                <input type="date" id="end-date">
                <button id="filter-button">ç¯©é¸</button>
            </div>
            <table id="analysis-table">
                <thead>
                    <tr>
                        <th>æ™‚é–“æ®µ</th>
                        <th>ä¾†å®¢æ•¸</th>
                        <th>æ¶ˆè²»é‡‘é¡ (å…ƒ)</th>
                        <th>å¹³å‡æ¶ˆè²»é‡‘é¡ (å…ƒ)</th>
                        <th>å¢é•·ç™¾åˆ†æ¯”</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>2024å¹´10æœˆ1æ—¥</td>
                        <td>150</td>
                        <td>30000</td>
                        <td>200</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td>2024å¹´10æœˆ2æ—¥</td>
                        <td>120</td>
                        <td>24000</td>
                        <td>200</td>
                        <td>-20%</td>
                    </tr>
                    <tr>
                        <td>2024å¹´10æœˆ3æ—¥</td>
                        <td>180</td>
                        <td>45000</td>
                        <td>250</td>
                        <td>50%</td>
                    </tr>
                    <tr>
                        <td>2024å¹´10æœˆ4æ—¥</td>
                        <td>200</td>
                        <td>60000</td>
                        <td>300</td>
                        <td>11.11%</td>
                    </tr>
                </tbody>
            </table>
        
            <div class="customer-type-analysis">
                <h4>å®¢æˆ¶é¡å‹åˆ†æ</h4>
                <table>
                    <thead>
                        <tr>
                            <th>å®¢æˆ¶é¡å‹</th>
                            <th>æ•¸é‡</th>
                            <th>æ¶ˆè²»é‡‘é¡ (å…ƒ)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>æ–°å®¢æˆ¶</td>
                            <td>50</td>
                            <td>12000</td>
                        </tr>
                        <tr>
                            <td>å›é ­å®¢</td>
                            <td>350</td>
                            <td>78000</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        
            <div class="export-report">
                <button id="export-button">å°å‡ºå ±å‘Š</button>
            </div>
        </div>                                    
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        //å®¢æˆ¶(é€²éšæœå°‹)
        function advancedCustomerSearch() {
            const nameInput = document.getElementById('search-customer-input').value.toLowerCase();
            const startDate = document.getElementById('search-customer-start').value;
            const endDate = document.getElementById('search-customer-end').value;
            const rows = document.querySelectorAll('#customer-tbody tr');
            let noResults = true;

            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                const customerName = cells[1].textContent.toLowerCase();
                const regDate = cells[4].textContent;
                let show = true;

                if (nameInput && !customerName.includes(nameInput)) show = false;
                if (startDate && regDate < startDate) show = false;
                if (endDate && regDate > endDate) show = false;

                row.style.display = show ? '' : 'none';
                if (show) noResults = false;
            });

            document.getElementById('no-results').style.display = noResults ? 'block' : 'none';
        }

        // æ—¥æœŸç¯©é¸åŠŸèƒ½
        document.getElementById('filter-button').addEventListener('click', function() {
            const startDate = new Date(document.getElementById('start-date').value);
            const endDate = new Date(document.getElementById('end-date').value);
            
            const rows = document.querySelectorAll('#analysis-table tbody tr');
            rows.forEach(row => {
                const dateCell = new Date(row.cells[0].innerText);
                if (dateCell >= startDate && dateCell <= endDate) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });

        // å°å‡ºå ±å‘ŠåŠŸèƒ½
        document.getElementById('export-button').addEventListener('click', function() {
            let csvContent = "data:text/csv;charset=utf-8,";
            const rows = document.querySelectorAll('#analysis-table tr');
            rows.forEach(row => {
                const cols = row.querySelectorAll('th, td');
                const rowData = Array.from(cols).map(col => col.innerText).join(",");
                csvContent += rowData + "\r\n";
            });
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "customer_analysis_report.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });

        //åº«å­˜ç•°å‹•è¡¨
        function showInventoryReport() {
            window.location.href = 'inventory.html';  
        }

        //è·³è½‰åˆ°è¨‚å–®ç®¡ç†
        function showOrderManagement() {
            window.location.href = 'order.html'; 
        }
        function debounce(fn, delay = 500) {
            let timer;

            return (...args) => {
                clearTimeout(timer);
                timer = setTimeout(() => {
                    fn(...args);
                }, delay);
            };
        }

        //é¡åˆ¥
        document.getElementById('add-category-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const categoryName = document.getElementById('category-name').value.trim();
            if (categoryName) {
                const categories = JSON.parse(localStorage.getItem('categories')) || [];
                if (!categories.includes(categoryName)) {
                    categories.push(categoryName);
                    localStorage.setItem('categories', JSON.stringify(categories));
                    initializeCategories();
                    document.getElementById('category-name').value = '';
                } else {
                    alert('é¡åˆ¥å·²å­˜åœ¨ï¼');
                }
            }
        });

        // åŠŸèƒ½ä»¥é¡¯ç¤ºâ€œæ·»åŠ å®¢æˆ¶â€æ¨¡å¼
        function showAddCustomerModal() {
            document.getElementById('add-customer-modal').style.display = 'block';
        }

        // éš±è—â€œæ·»åŠ å®¢æˆ¶â€æ¨¡å¼çš„åŠŸèƒ½
        function hideAddCustomerModal() {
            document.getElementById('add-customer-modal').style.display = 'none';
        }

        // å°‡äº‹ä»¶åµè½å™¨æ·»åŠ åˆ°â€œæ·»åŠ å®¢æˆ¶â€æŒ‰éˆ•
        document.getElementById('add-customer-btn').addEventListener('click', showAddCustomerModal);

        //ç™»å…¥è€…æ›´æ–°ç”¨æˆ¶ä¿¡æ¯
        document.addEventListener('DOMContentLoaded', function () {
            fetch('manage1.php')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('employee-name-info').textContent = data.username;
                })
                .catch(error => console.error('Error:', error));
        });

        //ç™»å…¥è€…
        document.addEventListener('DOMContentLoaded', function () {
            // å‡è¨­ä½ å¾ä¼ºæœå™¨ç²å–ç™»å…¥è€…çš„åç¨±å’Œé ­åƒ
            var isLoggedIn = false;  // æ ¹æ“šå¯¦éš›æƒ…æ³è¨­ç½®ï¼Œä¾‹å¦‚å¾ session æˆ–å¾Œç«¯è¿”å›çš„ç‹€æ…‹
            var employeeName = 'John Doe';  // å¾å¾Œç«¯ç²å–çš„ç™»å…¥è€…å§“å
            var avatarUrl = 'path-to-avatar.png';  // å¾å¾Œç«¯ç²å–çš„é ­åƒ URL

            if (isLoggedIn) {
                // å¦‚æœç”¨æˆ¶å·²ç™»å…¥ï¼Œé¡¯ç¤ºç™»å…¥è€…ä¿¡æ¯
                document.getElementById('employee-name').textContent = 'ç™»å…¥è€…: ' + employeeName;
                document.getElementById('employee-avatar').src = avatarUrl;
            } else {
                // å¦‚æœç”¨æˆ¶å°šæœªç™»å…¥ï¼Œé¡¯ç¤ºæç¤ºä¿¡æ¯
                document.getElementById('employee-name').textContent = 'å°šæœªç™»å…¥';
                document.getElementById('employee-avatar').src = 'cat.png';  // é è¨­é ­åƒ
            }
        });

        //é¦–é 
        document.addEventListener('DOMContentLoaded', () => {
            fetchData();
            setInterval(fetchData, 60000); // æ¯60ç§’åˆ·æ–°ä¸€æ¬¡æ•¸æ“š
        });

        async function fetchData() {
            try {
                const response = await fetch('data-endpoint.php'); // ä¿®æ”¹ä¸ºä½ çš„æ•¸æ“šç«¯é»
                const data = await response.json();

                // æ›´æ–°å„€è¡¨æ¿
                document.querySelector('#home .card:nth-child(1) p').textContent = data.orderCount;
                document.querySelector('#home .card:nth-child(2) p').textContent = `NT$ ${data.salesAmount}`;
                document.querySelector('#home .card:nth-child(3) p').textContent = data.newCustomers;
                document.querySelector('#home .card:nth-child(4) p').textContent = data.pendingOrders;

                updateChart('salesTrend', data.salesTrendData);
                updateChart('inventoryLevels', data.inventoryLevelsData);

                const latestOrders = data.latestOrders.map(order => `<li>è¨‚å–® #${order.id} - ${order.timeAgo}</li>`).join('');
                document.querySelector('#home .card:nth-child(7) ul').innerHTML = latestOrders;

                document.querySelector('#home .card:nth-child(8) p').textContent = data.systemNotification;

            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

        function updateChart(canvasId, chartData) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            if (window.myCharts && window.myCharts[canvasId]) {
                window.myCharts[canvasId].data.labels = chartData.labels;
                window.myCharts[canvasId].data.datasets[0].data = chartData.values;
                window.myCharts[canvasId].update();
            } else {
                window.myCharts = window.myCharts || {};
                window.myCharts[canvasId] = new Chart(ctx, {
                    type: 'line', // æˆ–å…¶ä»–ä½ éœ€è¦çš„åœ–è¡¨é¡å‹
                    data: {
                        labels: chartData.labels,
                        datasets: [{
                            label: 'æ•¸æ“š',
                            data: chartData.values,
                            borderColor: 'rgba(75, 192, 192, 1)',
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            x: { beginAtZero: true },
                            y: { beginAtZero: true }
                        }
                    }
                });
            }
        }

        //éŠ·å”®å ±è¡¨
        document.addEventListener('DOMContentLoaded', function () {
            // ç¤ºä¾‹æ•¸æ“šï¼ˆå¯¦éš›æ•¸æ“šæ‡‰å¾ä¼ºæœå™¨æˆ–è³‡æ–™åº«ç²å–ï¼‰
            const salesData = [
                { date: '2024-01', sales_amount: 10000 },
                { date: '2024-02', sales_amount: 12000 },
                { date: '2024-03', sales_amount: 9000 },
                // æ·»åŠ æ›´å¤šæ•¸æ“š
            ];

            const costProfitData = [
                { date: '2024-01', cost: 5000, gross_profit: 3000, net_profit: 2000 },
                { date: '2024-02', cost: 6000, gross_profit: 4000, net_profit: 2500 },
                { date: '2024-03', cost: 4500, gross_profit: 2500, net_profit: 1500 },
                // æ·»åŠ æ›´å¤šæ•¸æ“š
            ];

            const salesTrendData = [
                { date: '2024-01', trend: 5 },
                { date: '2024-02', trend: 7 },
                { date: '2024-03', trend: 6 },
                // æ·»åŠ æ›´å¤šæ•¸æ“š
            ];

            const charts = [
                {
                    id: 'salesDataChart',
                    type: 'line',
                    data: {
                        labels: salesData.map(item => item.date),
                        datasets: [{
                            label: 'éŠ·å”®é¡',
                            data: salesData.map(item => item.sales_amount),
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function (tooltipItem) {
                                        return `éŠ·å”®é¡: ${tooltipItem.raw}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: { beginAtZero: true },
                            y: { beginAtZero: true }
                        }
                    }
                },
                {
                    id: 'costProfitChart',
                    type: 'bar',
                    data: {
                        labels: costProfitData.map(item => item.date),
                        datasets: [
                            {
                                label: 'æˆæœ¬',
                                data: costProfitData.map(item => item.cost),
                                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                                borderColor: 'rgba(255, 99, 132, 1)',
                                borderWidth: 1
                            },
                            {
                                label: 'æ¯›åˆ©',
                                data: costProfitData.map(item => item.gross_profit),
                                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                borderColor: 'rgba(54, 162, 235, 1)',
                                borderWidth: 1
                            },
                            {
                                label: 'æ·¨åˆ©æ½¤',
                                data: costProfitData.map(item => item.net_profit),
                                backgroundColor: 'rgba(255, 206, 86, 0.2)',
                                borderColor: 'rgba(255, 206, 86, 1)',
                                borderWidth: 1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function (tooltipItem) {
                                        const dataset = tooltipItem.dataset.label;
                                        const value = tooltipItem.raw;
                                        return `${dataset}: ${value}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: { beginAtZero: true },
                            y: { beginAtZero: true }
                        }
                    }
                },
                {
                    id: 'salesTrendChart',
                    type: 'line',
                    data: {
                        labels: salesTrendData.map(item => item.date),
                        datasets: [{
                            label: 'éŠ·å”®è¶¨å‹¢',
                            data: salesTrendData.map(item => item.trend),
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1,
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function (tooltipItem) {
                                        return `è¶¨å‹¢: ${tooltipItem.raw}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: { beginAtZero: true },
                            y: { beginAtZero: true }
                        }
                    }
                },
                {
                    id: 'customerAnalysisChart',
                    type: 'pie',
                    data: {
                        labels: ['æ–°å®¢æˆ¶', 'ç¾æœ‰å®¢æˆ¶'],
                        datasets: [{
                            label: 'å®¢æˆ¶é¡å‹',
                            data: [300, 500], // ç¤ºä¾‹æ•¸æ“š
                            backgroundColor: ['rgba(75, 192, 192, 0.2)', 'rgba(255, 159, 64, 0.2)'],
                            borderColor: ['rgba(75, 192, 192, 1)', 'rgba(255, 159, 64, 1)'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function (tooltipItem) {
                                        const dataset = tooltipItem.dataset.label;
                                        const value = tooltipItem.raw;
                                        return `${dataset}: ${value}`;
                                    }
                                }
                            }
                        }
                    }
                },
                {
                    id: 'regionalMarketChart',
                    type: 'bar',
                    data: {
                        labels: ['åŒ—å€', 'å—å€', 'æ±å€', 'è¥¿å€'],
                        datasets: [{
                            label: 'éŠ·å”®é¡',
                            data: [12000, 15000, 18000, 10000], // ç¤ºä¾‹æ•¸æ“š
                            backgroundColor: 'rgba(153, 102, 255, 0.2)',
                            borderColor: 'rgba(153, 102, 255, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function (tooltipItem) {
                                        const dataset = tooltipItem.dataset.label;
                                        const value = tooltipItem.raw;
                                        return `${dataset}: ${value}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: { beginAtZero: true },
                            y: { beginAtZero: true }
                        }
                    }
                },
                {
                    id: 'productServiceChart',
                    type: 'doughnut',
                    data: {
                        labels: ['ç”¢å“A', 'ç”¢å“B', 'ç”¢å“C', 'æœå‹™D'],
                        datasets: [{
                            label: 'éŠ·å”®é¡',
                            data: [10000, 15000, 12000, 8000], // ç¤ºä¾‹æ•¸æ“š
                            backgroundColor: ['rgba(255, 99, 132, 0.2)', 'rgba(54, 162, 235, 0.2)', 'rgba(255, 206, 86, 0.2)', 'rgba(75, 192, 192, 0.2)'],
                            borderColor: ['rgba(255, 99, 132, 1)', 'rgba(54, 162, 235, 1)', 'rgba(255, 206, 86, 1)', 'rgba(75, 192, 192, 1)'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function (tooltipItem) {
                                        const dataset = tooltipItem.dataset.label;
                                        const value = tooltipItem.raw;
                                        return `${dataset}: ${value}`;
                                    }
                                }
                            }
                        }
                    }
                },
                {
                    id: 'salesChannelChart',
                    type: 'bar',
                    data: {
                        labels: ['ç·šä¸Š', 'å¯¦é«”åº—', 'é›»è©±è¨‚å–®', 'å…¶ä»–'],
                        datasets: [{
                            label: 'éŠ·å”®æ¸ é“è²¢ç»',
                            data: [40000, 25000, 15000, 5000], // ç¤ºä¾‹æ•¸æ“š
                            backgroundColor: 'rgba(255, 159, 64, 0.2)',
                            borderColor: 'rgba(255, 159, 64, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function (tooltipItem) {
                                        const dataset = tooltipItem.dataset.label;
                                        const value = tooltipItem.raw;
                                        return `${dataset}: ${value}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: { beginAtZero: true },
                            y: { beginAtZero: true }
                        }
                    }
                },
                {
                    id: 'salesPerformanceChart',
                    type: 'radar',
                    data: {
                        labels: ['éŠ·å”®é¡', 'å®¢æˆ¶æ»¿æ„åº¦', 'å›å ±ç‡', 'å®Œæˆç›®æ¨™'],
                        datasets: [{
                            label: 'éŠ·å”®äººå“¡A',
                            data: [80, 90, 85, 70], // ç¤ºä¾‹æ•¸æ“š
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        }, {
                            label: 'éŠ·å”®äººå“¡B',
                            data: [70, 80, 75, 60], // ç¤ºä¾‹æ•¸æ“š
                            backgroundColor: 'rgba(153, 102, 255, 0.2)',
                            borderColor: 'rgba(153, 102, 255, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function (tooltipItem) {
                                        const dataset = tooltipItem.dataset.label;
                                        const value = tooltipItem.raw;
                                        return `${dataset}: ${value}`;
                                    }
                                }
                            }
                        }
                    }
                }
            ];

            charts.forEach(chart => {
                const ctx = document.getElementById(chart.id).getContext('2d');
                new Chart(ctx, chart);
            });
        });

        // (é¡åˆ¥ç®¡ç†)åˆå§‹åŒ–é¡åˆ«æ•¸æ“š
        const initializeCategories = () => {
            const categories = JSON.parse(localStorage.getItem('categories')) || [];
            const categoryList = document.getElementById('category-list');
            const editCategorySelect = document.getElementById('edit-category-select');
            const deleteCategorySelect = document.getElementById('delete-category-select');

            // æ¸…ç©ºåˆ—è¡¨å’Œä¸‹æ‹‰èœå–®
            categoryList.innerHTML = '';
            editCategorySelect.innerHTML = '';
            deleteCategorySelect.innerHTML = '';

            categories.forEach(category => {
                // æ·»åŠ åˆ°åˆ—è¡¨
                const li = document.createElement('li');
                li.textContent = category;
                categoryList.appendChild(li);

                // æ·»åŠ åˆ°ä¸‹æ‹‰èœå–®
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                editCategorySelect.appendChild(option.cloneNode(true));
                deleteCategorySelect.appendChild(option);
            });
        };

        // æ·»åŠ é¡åˆ«
        document.getElementById('add-category-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const categoryName = document.getElementById('category-name').value.trim();
            if (categoryName) {
                const categories = JSON.parse(localStorage.getItem('categories')) || [];
                if (!categories.includes(categoryName)) {
                    categories.push(categoryName);
                    localStorage.setItem('categories', JSON.stringify(categories));
                    initializeCategories();
                    document.getElementById('category-name').value = '';
                } else {
                    alert('é¡åˆ«å·²å­˜åœ¨ï¼');
                }
            }
        });

        // ç·¨è¼¯é¡åˆ«
        document.getElementById('edit-category-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const oldCategoryName = document.getElementById('edit-category-select').value;
            const newCategoryName = document.getElementById('new-category-name').value.trim();
            if (newCategoryName) {
                const categories = JSON.parse(localStorage.getItem('categories')) || [];
                const index = categories.indexOf(oldCategoryName);
                if (index > -1) {
                    categories[index] = newCategoryName;
                    localStorage.setItem('categories', JSON.stringify(categories));
                    initializeCategories();
                    document.getElementById('new-category-name').value = '';
                }
            }
        });

        // åˆ é™¤é¡åˆ«
        document.getElementById('delete-category-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const categoryName = document.getElementById('delete-category-select').value;
            const categories = JSON.parse(localStorage.getItem('categories')) || [];
            const index = categories.indexOf(categoryName);
            if (index > -1) {
                categories.splice(index, 1);
                localStorage.setItem('categories', JSON.stringify(categories));
                initializeCategories();
            }
        });

        // åˆå§‹åŒ–é é¢
        initializeCategories();

        // (åº«å­˜ç®¡ç†)åˆå§‹åŒ–åº«å­˜æ•¸æ“š
        function initializeInventory() {
            if (!localStorage.getItem('inventory')) {
                const initialInventory = [
                    { item: 'é®­é­š', quantity: 50 },
                    { item: 'é›è‚‰', quantity: 75 },
                    { item: 'é®®è¦', quantity: 60 },
                    { item: 'è±†è…', quantity: 66 },
                    { item: 'ç‰å­ç‡’', quantity: 80 },
                    { item: 'åœ°ç“œæ³¥', quantity: 60 },
                    { item: 'æ°´ç…®è›‹', quantity: 75 },
                    { item: 'èŠ±æ¤°èœ', quantity: 75 },
                    { item: 'æé®‘è‡', quantity: 85 },
                    { item: 'ç« é­š', quantity: 50 },
                    { item: 'é®ªé­š', quantity: 90 },
                    { item: 'ç´«è–¯æ³¥', quantity: 70 },
                    { item: 'ç‰ç±³ç­', quantity: 88 },
                    { item: 'é»ƒé‡‘æ³¡èœ', quantity: 66 },
                    { item: 'æ´‹è”¥', quantity: 45 },
                    { item: 'æµ·å¸¶çµ²', quantity: 75 },
                    { item: 'ç‰ç±³ç²’', quantity: 55 },
                ];
                localStorage.setItem('inventory', JSON.stringify(initialInventory));
            }
        }

        // åŠ è¼‰åº«å­˜æ•¸æ“šä¸¦é¡¯ç¤º
        function loadInventory() {
            const inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            displayInventory(inventory);
        }

        // é¡¯ç¤ºåº«å­˜æ•¸æ“š
        function displayInventory(data) {
            const tableBody = document.querySelector('table tbody');
            tableBody.innerHTML = '';  // å…ˆæ¸…ç©ºè¡¨æ ¼

            data.forEach((item, index) => {
                const row = document.createElement('tr');

                // æ ¹æ“šæ˜¯å¦åœç”¨ä¾†æ”¹è®Šé¡¯ç¤º
                const status = item.disabled ? 'åœç”¨' : 'å•Ÿç”¨';
                const statusColor = item.disabled ? 'red' : 'green';

                row.innerHTML = `
                    <td><input type="checkbox" data-index="${index}" ${item.disabled ? 'disabled' : ''}></td>
                    <td>${item.item}</td>
                    <td>${item.quantity}</td>
                    <td style="color: ${statusColor}">${status}</td>
                    <td>
                        <button onclick="editInventory(${index})">ç·¨è¼¯</button>
                        <button onclick="disableInventory(${index})" ${item.disabled ? 'disabled' : ''}>åœç”¨</button>
                        <button onclick="enableInventory(${index})" ${!item.disabled ? 'disabled' : ''}>å•Ÿç”¨</button>
                        <button onclick="increaseQuantity(${index})">å¢åŠ æ•¸é‡</button>
                        <button onclick="decreaseQuantity(${index})">æ¸›å°‘æ•¸é‡</button>
                        <button onclick="viewItemDetails(${index})">æŸ¥çœ‹è©³æƒ…</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }


        // æ·»åŠ åº«å­˜æ•¸æ“š
        function addInventory(item, quantity) {
            const inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            inventory.push({ item, quantity });
            localStorage.setItem('inventory', JSON.stringify(inventory));
            loadInventory();
        }

        // ç·¨è¼¯åº«å­˜æ•¸æ“š
        function editInventory(index) {
            const inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            const newItem = prompt("è«‹è¼¸å…¥æ–°çš„åº«å­˜é …ç›®åç¨±", inventory[index].item);
            const newQuantity = prompt("è«‹è¼¸å…¥æ–°çš„æ•¸é‡", inventory[index].quantity);
            if (newItem !== null && newQuantity !== null) {
                inventory[index] = { item: newItem, quantity: parseInt(newQuantity) };
                localStorage.setItem('inventory', JSON.stringify(inventory));
                loadInventory();
            }
        }


        // åœç”¨åº«å­˜æ•¸æ“š
        /*function deleteInventory(index) {
            const inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            inventory.splice(index, 1);
            localStorage.setItem('inventory', JSON.stringify(inventory));
            loadInventory();
        }*/
        // åœç”¨åº«å­˜æ•¸æ“š
        function disableInventory(index) {
            const inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            if (index >= 0 && index < inventory.length) {
                inventory[index].disabled = true;  // è¨­ç½®ç‚ºåœç”¨
                localStorage.setItem('inventory', JSON.stringify(inventory));
                
                // ç›´æ¥æ›´æ–°é¡¯ç¤ºåº«å­˜
                displayInventory(inventory);  // ä¸å†ç­‰å¾… loadInventory()
            }
        }

        // å•Ÿç”¨åº«å­˜æ•¸æ“š
        function enableInventory(index) {
            const inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            if (index >= 0 && index < inventory.length) {
                inventory[index].disabled = false;  // è¨­ç½®ç‚ºå•Ÿç”¨
                localStorage.setItem('inventory', JSON.stringify(inventory));
                
                // ç›´æ¥æ›´æ–°é¡¯ç¤ºåº«å­˜
                displayInventory(inventory);  // ä¸å†ç­‰å¾… loadInventory()
            }
        }

        // æ‰¹é‡åˆªé™¤é¸ä¸­é …ç›®
        /*function deleteSelectedItems() {
            let inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            const checkboxes = document.querySelectorAll('table tbody input[type="checkbox"]');
            checkboxes.forEach((checkbox, index) => {
                if (checkbox.checked) {
                    inventory.splice(index, 1);
                }
            });
            localStorage.setItem('inventory', JSON.stringify(inventory));
            loadInventory();
        }*/

        // å°å‡ºåº«å­˜æ•¸æ“š
        function exportInventory() {
            const inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            let csvContent = "\uFEFF" + "é …ç›®,æ•¸é‡\n";
            inventory.forEach(item => {
                csvContent += `${item.item},${item.quantity}\n`;
            });
            const encodedUri = "data:text/csv;charset=utf-8," + encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "inventory.csv");
            document.body.appendChild(link);
            link.click();
        }

        // å°å…¥åº«å­˜æ•¸æ“š
        function importInventory(event) {
            const file = event.target.files[0];
            const reader = new FileReader();
            reader.onload = function (e) {
                const contents = e.target.result;
                const rows = contents.split('\n').slice(1);
                const newInventory = rows.map(row => {
                    const [item, quantity] = row.split(',');
                    return { item, quantity: parseInt(quantity) };
                }).filter(item => item.item);
                localStorage.setItem('inventory', JSON.stringify(newInventory));
                loadInventory();
            };
            reader.readAsText(file);
        }

        // æœå°‹åº«å­˜é …ç›®
        function searchInventory() {
            const searchTerm = document.getElementById('search-item').value.toLowerCase();
            const inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            const filteredInventory = inventory.filter(item => item.item.toLowerCase().includes(searchTerm));
            displayInventory(filteredInventory);
        }

        // å¢åŠ åº«å­˜æ•¸é‡
        function increaseQuantity(index) {
            const inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            inventory[index].quantity += 1;
            localStorage.setItem('inventory', JSON.stringify(inventory));
            loadInventory();
        }

        // æ¸›å°‘åº«å­˜æ•¸é‡
        function decreaseQuantity(index) {
            const inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            if (inventory[index].quantity > 0) {
                inventory[index].quantity -= 1;
                localStorage.setItem('inventory', JSON.stringify(inventory));
                loadInventory();
            } else {
                alert("æ•¸é‡ä¸èƒ½ç‚ºè² æ•¸");
            }
        }

        // æŸ¥çœ‹åº«å­˜é …ç›®è©³æƒ…
        function viewItemDetails(index) {
            const inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            const item = inventory[index];
            alert(`é …ç›®: ${item.item}\næ•¸é‡: ${item.quantity}`);
        }

        // è¡¨å–®æäº¤äº‹ä»¶è™•ç†
        document.getElementById('inventory-form').addEventListener('submit', function (e) {
            e.preventDefault();
            const item = document.getElementById('inventory-item').value;
            const quantity = document.getElementById('inventory-quantity').value;
            addInventory(item, quantity);
            document.getElementById('inventory-form').reset();
        });

        // åˆå§‹åŒ–ä¸¦åŠ è¼‰åº«å­˜
        initializeInventory();
        loadInventory();

        //å“¡å·¥
        window.onload = function () {
            fetchStaff();
        };

        // åˆ†é ç›¸é—œè®Šæ•¸
        let staffData = [];
        let staffCurrentPage = 1;
        const staffPageSize = 10;


        // ç²å–å“¡å·¥è³‡æ–™ä¸¦å¡«å……è¡¨æ ¼
        function fetchStaff() {
            fetch('get-data.php')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('ç¶²çµ¡éŸ¿æ‡‰ä¸æ˜¯ OK');
                    }
                    return response.json();
                })
                .then(data => {
                    staffData = data;
                    staffCurrentPage = 1;
                    renderStaffTable();
                    updateStaffPagination();
                })
                .catch(error => console.error('ç²å–è³‡æ–™å¤±æ•—:', error));
        }

        // æ¸²æŸ“åˆ†é å¾Œçš„å“¡å·¥è¡¨æ ¼
        function renderStaffTable() {
            const tableBody = document.querySelector('#staffTable tbody');
            if (!tableBody) return;
            tableBody.innerHTML = '';
            const start = (staffCurrentPage - 1) * staffPageSize;
            const end = start + staffPageSize;
            const pageData = staffData.slice(start, end);
            pageData.forEach(staff => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${staff.member_ID}</td>
                    <td>${staff.name}</td>
                    <td>${staff.gender}</td>
                    <td>${staff.position}</td>
                    <td>${staff.phone}</td>
                    <td>${staff.email}</td>
                    <td>
                        <button onclick="editStaff(${staff.member_ID})">ç·¨è¼¯</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // æ›´æ–°åˆ†é è³‡è¨Š
        function updateStaffPagination() {
            const totalPages = Math.ceil(staffData.length / staffPageSize) || 1;
            document.getElementById('staff-page-info').textContent = `ç¬¬ ${staffCurrentPage} / ${totalPages} é `;
            document.getElementById('staff-prev-btn').disabled = staffCurrentPage === 1;
            document.getElementById('staff-next-btn').disabled = staffCurrentPage === totalPages;
        }

        // åˆ‡æ›åˆ†é 
        function changeStaffPage(delta) {
            const totalPages = Math.ceil(staffData.length / staffPageSize) || 1;
            staffCurrentPage += delta;
            if (staffCurrentPage < 1) staffCurrentPage = 1;
            if (staffCurrentPage > totalPages) staffCurrentPage = totalPages;
            renderStaffTable();
            updateStaffPagination();
        }

        // æœå°‹å“¡å·¥æ™‚ä¹Ÿè¦åˆ†é 
        function searchStaff() {
            const input = document.getElementById('searchInput');
            const filter = input.value.toLowerCase();
            const filtered = staffData.filter(staff =>
                staff.member_ID.toString().includes(filter) ||
                staff.name.toLowerCase().includes(filter) ||
                staff.gender.toLowerCase().includes(filter) ||
                staff.position.toLowerCase().includes(filter) ||
                staff.phone.toLowerCase().includes(filter) ||
                staff.email.toLowerCase().includes(filter)
            );
            staffCurrentPage = 1;
            staffDataFiltered = filtered;
            renderStaffTableFiltered(filtered);
            updateStaffPaginationFiltered(filtered);
        }

        // åˆ†é æ¸²æŸ“æœå°‹çµæœ
        function renderStaffTableFiltered(filtered) {
            const tableBody = document.querySelector('#staffTable tbody');
            if (!tableBody) return;
            tableBody.innerHTML = '';
            const start = (staffCurrentPage - 1) * staffPageSize;
            const end = start + staffPageSize;
            const pageData = filtered.slice(start, end);
            pageData.forEach(staff => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${staff.member_ID}</td>
                    <td>${staff.name}</td>
                    <td>${staff.gender}</td>
                    <td>${staff.position}</td>
                    <td>${staff.phone}</td>
                    <td>${staff.email}</td>
                    <td>
                        <button onclick="editStaff(${staff.member_ID})">ç·¨è¼¯</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // æ›´æ–°æœå°‹åˆ†é è³‡è¨Š
        function updateStaffPaginationFiltered(filtered) {
            const totalPages = Math.ceil(filtered.length / staffPageSize) || 1;
            document.getElementById('staff-page-info').textContent = `ç¬¬ ${staffCurrentPage} / ${totalPages} é `;
            document.getElementById('staff-prev-btn').disabled = staffCurrentPage === 1;
            document.getElementById('staff-next-btn').disabled = staffCurrentPage === totalPages;
        }

        // ä¿®æ”¹åˆ†é æŒ‰éˆ•äº‹ä»¶ï¼Œæœå°‹æ™‚ä¹Ÿèƒ½åˆ‡æ›
        document.getElementById('staff-prev-btn').onclick = function() {
            if (typeof staffDataFiltered !== 'undefined') {
                if (staffCurrentPage > 1) {
                    staffCurrentPage--;
                    renderStaffTableFiltered(staffDataFiltered);
                    updateStaffPaginationFiltered(staffDataFiltered);
                }
            } else {
                changeStaffPage(-1);
            }
        };
        document.getElementById('staff-next-btn').onclick = function() {
            if (typeof staffDataFiltered !== 'undefined') {
                const totalPages = Math.ceil(staffDataFiltered.length / staffPageSize) || 1;
                if (staffCurrentPage < totalPages) {
                    staffCurrentPage++;
                    renderStaffTableFiltered(staffDataFiltered);
                    updateStaffPaginationFiltered(staffDataFiltered);
                }
            } else {
                changeStaffPage(1);
            }
        };

        //æ–°å¢å“¡å·¥
        function submitEmployeeForm() {
            const form = document.getElementById('employee-form');
            const formData = new FormData(form);

            fetch('add-employee.php', {
                method: 'POST',
                body: formData
            })
                .then(response => response.json())
                .then(result => {
                    if (result.success) {
                        alert('å“¡å·¥å·²æˆåŠŸæ–°å¢');
                        fetchStaff(); // é‡æ–°åŠ è¼‰å“¡å·¥è³‡æ–™
                        form.reset(); // æ¸…ç©ºè¡¨å–®
                    } else {
                        alert('æ–°å¢å¤±æ•—: ' + result.message);
                    }
                })
                .catch(error => console.error('æäº¤å¤±æ•—:', error));

            return false; // é˜²æ­¢è¡¨å–®çš„é è¨­æäº¤è¡Œç‚º
        }

        // ç·¨è¼¯å“¡å·¥è³‡æ–™
        function editStaff(id) {
            fetch(`get-staff.php?id=${id}`)
                .then(response => response.json())
                .then(staff => {
                    document.getElementById('editName').value = staff.name;
                    document.getElementById('editGender').value = staff.gender;
                    document.getElementById('editPosition').value = staff.position;
                    document.getElementById('editPhone').value = staff.phone;
                    document.getElementById('editEmail').value = staff.email;
                    document.getElementById('editId').value = staff.member_ID;
                    document.getElementById('editModal').style.display = 'block'; // é¡¯ç¤ºæ¨¡æ€æ¡†
                })
                .catch(error => console.error('ç²å–å–å“¡å·¥æ•¸æ“šå¤±æ•—:', error));
        }

        // ä¿å­˜ç¼–è¾‘çš„å“¡å·¥ä¿¡æ¯
        function submitEdit() {
            const formData = new FormData(document.getElementById('editForm'));

            fetch('update-data.php', {
                method: 'POST',
                body: formData
            })
                .then(response => response.json())
                .then(result => {
                    if (result.success) {
                        alert('å“¡å·¥ä¿¡æ¯å·²æ›´æ–°');
                        fetchStaff(); // é‡æ–°åŠ è½½å“¡å·¥æ•¸æ“š
                        closeEditModal(); // é—œé–‰æ¨¡æ…‹æ¡†
                    } else {
                        alert('æ›´æ–°å¤±è´¥');
                    }
                })
                .catch(error => console.error('æ›´æ–°æ•°æ®å¤±è´¥:', error));
        }

        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none'; // é—œé–‰æ¨¡æ€æ¡†
        }

        // åˆªé™¤å“¡å·¥
        function deleteStaff(id) {
            if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹å“¡å·¥å—ï¼Ÿ')) {
                fetch(`delete-data.php?id=${id}`, { method: 'DELETE' })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('åˆªé™¤è«‹æ±‚å¤±æ•—');
                        }
                        return response.json();
                    })
                    .then(result => {
                        if (result.success) {
                            alert('å“¡å·¥å·²åˆªé™¤');
                            fetchStaff(); // é‡æ–°åŠ è¼‰å“¡å·¥è³‡æ–™
                        } else {
                            alert('åˆªé™¤å¤±æ•—');
                        }
                    })
                    .catch(error => console.error('åˆªé™¤è³‡æ–™å¤±æ•—:', error));
            }
        }

        //å®¢æˆ¶
        document.addEventListener('DOMContentLoaded', function () {
            loadCustomerList(); // åœ¨é é¢åŠ è¼‰æ™‚èª¿ç”¨
            document.getElementById('search-button').addEventListener('click', searchCustomers); // æ·»åŠ äº‹ä»¶ç›£è½
        });

        // å®¢æˆ¶åˆ†é ç›¸é—œè®Šæ•¸
        let customerData = [];
        let customerCurrentPage = 1;
        const customerPageSize = 10;
        let customerDataFiltered = undefined;


        // åŠ è¼‰ä¸¦é¡¯ç¤ºå®¢æˆ¶åˆ—è¡¨
        function loadCustomerList() {
            fetch('get-customers.php')
                .then(response => response.json())
                .then(data => {
                    customerData = data;
                    customerCurrentPage = 1;
                    customerDataFiltered = undefined;
                    renderCustomerTable();
                    updateCustomerPagination();
                })
                .catch(error => console.error('Error fetching customer data:', error));
        }

        // æ¸²æŸ“åˆ†é å¾Œçš„å®¢æˆ¶è¡¨æ ¼
        function renderCustomerTable() {
            const customerTbody = document.getElementById('customer-tbody');
            if (!customerTbody) return;
            customerTbody.innerHTML = '';
            const start = (customerCurrentPage - 1) * customerPageSize;
            const end = start + customerPageSize;
            const pageData = customerData.slice(start, end);
            pageData.forEach(customer => {
                const row = `
                    <tr>
                        <td>${customer.Customer_ID}</td>
                        <td>${customer.name}</td>
                        <td>${customer.phone}</td>
                        <td>${customer.email}</td>
                        <td>${customer.date}</td>
                        <td><button onclick="openEditCustomerModal(${customer.Customer_ID}, '${customer.name}', '${customer.phone}', '${customer.email}', '${customer.date}')">ç·¨è¼¯</button></td>
                    </tr>
                `;
                customerTbody.innerHTML += row;
            });
        }

        // æ›´æ–°åˆ†é è³‡è¨Š
        function updateCustomerPagination() {
            const totalPages = Math.ceil(customerData.length / customerPageSize) || 1;
            document.getElementById('customer-page-info').textContent = `ç¬¬ ${customerCurrentPage} / ${totalPages} é `;
            document.getElementById('customer-prev-btn').disabled = customerCurrentPage === 1;
            document.getElementById('customer-next-btn').disabled = customerCurrentPage === totalPages;
        }

        // åˆ‡æ›åˆ†é 
        function changeCustomerPage(delta) {
            let data = customerDataFiltered !== undefined ? customerDataFiltered : customerData;
            const totalPages = Math.ceil(data.length / customerPageSize) || 1;
            customerCurrentPage += delta;
            if (customerCurrentPage < 1) customerCurrentPage = 1;
            if (customerCurrentPage > totalPages) customerCurrentPage = totalPages;
            if (customerDataFiltered !== undefined) {
                renderCustomerTableFiltered(customerDataFiltered);
                updateCustomerPaginationFiltered(customerDataFiltered);
            } else {
                renderCustomerTable();
                updateCustomerPagination();
            }
        }

        // todo filter
        const updateDebounceText = debounce(() => {
            const input = document.getElementById('search-customer-input').value.toLowerCase();
            console.log(input);
            const rows = document.querySelectorAll('#customer-tbody tr');

            let noResults = true;
            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                const customerName = cells[1].textContent.toLowerCase(); // å‡è¨­ç¬¬2æ¬„æ˜¯å®¢æˆ¶å§“å

                // æ¯”è¼ƒå®¢æˆ¶å§“åå’Œè¼¸å…¥
                if (customerName.includes(input)) {
                    row.style.display = ''; // é¡¯ç¤ºåŒ¹é…çš„è¡Œ
                    noResults = false;
                } else {
                    row.style.display = 'none'; // éš±è—ä¸åŒ¹é…çš„è¡Œ
                }
            });

            // é¡¯ç¤ºæˆ–éš±è—æ²’æœ‰çµæœçš„æç¤º
            document.getElementById('no-results').style.display = noResults ? 'block' : 'none';
        }, 500);


        // æœå°‹å®¢æˆ¶æ™‚ä¹Ÿè¦åˆ†é 
        function searchCustomers() {
            updateDebounceText();
            const input = document.getElementById('search-customer-input').value.toLowerCase();
            const filtered = customerData.filter(customer =>
                customer.Customer_ID.toString().includes(input) ||
                customer.name.toLowerCase().includes(input) ||
                customer.phone.toLowerCase().includes(input) ||
                customer.email.toLowerCase().includes(input) ||
                customer.date.toLowerCase().includes(input)
            );
            customerCurrentPage = 1;
            customerDataFiltered = filtered;
            renderCustomerTableFiltered(filtered);
            updateCustomerPaginationFiltered(filtered);
        }

        // åˆ†é æ¸²æŸ“æœå°‹çµæœ
        function renderCustomerTableFiltered(filtered) {
            const customerTbody = document.getElementById('customer-tbody');
            if (!customerTbody) return;
            customerTbody.innerHTML = '';
            const start = (customerCurrentPage - 1) * customerPageSize;
            const end = start + customerPageSize;
            const pageData = filtered.slice(start, end);
            pageData.forEach(customer => {
                const row = `
                    <tr>
                        <td>${customer.Customer_ID}</td>
                        <td>${customer.name}</td>
                        <td>${customer.phone}</td>
                        <td>${customer.email}</td>
                        <td>${customer.date}</td>
                        <td><button onclick="openEditCustomerModal(${customer.Customer_ID}, '${customer.name}', '${customer.phone}', '${customer.email}', '${customer.date}')">ç·¨è¼¯</button></td>
                    </tr>
                `;
                customerTbody.innerHTML += row;
            });
        }

        // æ›´æ–°æœå°‹åˆ†é è³‡è¨Š
        function updateCustomerPaginationFiltered(filtered) {
            const totalPages = Math.ceil(filtered.length / customerPageSize) || 1;
            document.getElementById('customer-page-info').textContent = `ç¬¬ ${customerCurrentPage} / ${totalPages} é `;
            document.getElementById('customer-prev-btn').disabled = customerCurrentPage === 1;
            document.getElementById('customer-next-btn').disabled = customerCurrentPage === totalPages;
        }

        // ä¿®æ”¹åˆ†é æŒ‰éˆ•äº‹ä»¶ï¼Œæœå°‹æ™‚ä¹Ÿèƒ½åˆ‡æ›
        document.getElementById('customer-prev-btn').onclick = function() {
            if (customerDataFiltered !== undefined) {
                if (customerCurrentPage > 1) {
                    customerCurrentPage--;
                    renderCustomerTableFiltered(customerDataFiltered);
                    updateCustomerPaginationFiltered(customerDataFiltered);
                }
            } else {
                changeCustomerPage(-1);
            }
        };
        document.getElementById('customer-next-btn').onclick = function() {
            let data = customerDataFiltered !== undefined ? customerDataFiltered : customerData;
            const totalPages = Math.ceil(data.length / customerPageSize) || 1;
            if (customerCurrentPage < totalPages) {
                customerCurrentPage++;
                if (customerDataFiltered !== undefined) {
                    renderCustomerTableFiltered(customerDataFiltered);
                    updateCustomerPaginationFiltered(customerDataFiltered);
                } else {
                    renderCustomerTable();
                    updateCustomerPagination();
                }
            }
        };


        // æ‰“é–‹ç·¨è¼¯å®¢æˆ¶æ¨¡æ…‹æ¡†
        function openEditCustomerModal(customerId, name, phone, email, date) {
            document.getElementById('edit-customer-id').value = customerId;
            document.getElementById('edit-customer-name').value = name;
            document.getElementById('edit-customer-phone').value = phone;
            document.getElementById('edit-customer-email').value = email;
            document.getElementById('edit-customer-date').value = date;
            document.getElementById('edit-customer-modal').style.display = 'block';
        }

        // éš±è—ç·¨è¼¯æ¨¡æ…‹æ¡†
        function hideEditCustomerModal() {
            document.getElementById('edit-customer-modal').style.display = 'none';
        }

        // æäº¤ç·¨è¼¯å¾Œçš„è³‡æ–™
        document.getElementById('edit-customer-form').addEventListener('submit', function (e) {
            e.preventDefault();

            const customerId = document.getElementById('edit-customer-id').value;
            const name = document.getElementById('edit-customer-name').value;
            const phone = document.getElementById('edit-customer-phone').value;
            const email = document.getElementById('edit-customer-email').value;
            const date = document.getElementById('edit-customer-date').value;

            fetch('edit-customer.php', {
                method: 'POST',
                body: JSON.stringify({
                    id: customerId,
                    name: name,
                    phone: phone,
                    email: email,
                    date: date
                }),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('å®¢æˆ¶æ›´æ–°æˆåŠŸ!');
                        hideEditCustomerModal();
                        loadCustomerList(); // æ›´æ–°å®¢æˆ¶åˆ—è¡¨
                    } else {
                        alert('æ›´æ–°å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚');
                    }
                })
                .catch(error => console.error('Error:', error));
        });

        //èœå–®
        // ç²å–å’Œé¡¯ç¤ºèœå–®æ•¸æ“šçš„åŠŸèƒ½
        function fetchAndDisplayMenu() {
            fetch('http://localhost/ouo/get-menu-data.php')
                .then(response => response.json())
                .then(data => displayMenu(data))
                .catch(error => console.error('Error fetching menu data:', error));
        }

        // é¡¯ç¤ºèœå–®è³‡æ–™
        function displayMenu(data) {
            const menuList = document.getElementById('menu-list-content');
            menuList.innerHTML = '';  // æ¸…ç©ºç¾æœ‰å…§å®¹

            // SetMeals è¡¨æ ¼
            menuList.innerHTML += `
                <table border="1" cellspacing="0" cellpadding="10">
                    <thead>
                        <tr>
                            <th>åœ–ç‰‡</th>
                            <th>åç¨±</th>
                            <th>åƒ¹æ ¼</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${data.SetMeals.map(menu => {
                            let imageUrl;
                            switch (menu.MenuName) {
                                case 'è±ªè¯æ³¢å¥‡': imageUrl = 'http://localhost/ouo/Deluxe%20Poch.jpg'; break;
                                case 'ç´ é£Ÿæ³¢å¥‡': imageUrl = 'http://localhost/ouo/Vegetarian%20Pochi.jpg'; break;
                                case 'ç°¡å–®æ³¢å¥‡': imageUrl = 'http://localhost/ouo/Simple%20Poch.jpg'; break;
                                default: imageUrl = 'http://localhost/ouo/default-image.jpg';
                            }

                            // æ–°å¢ data-id, data-name, data-price å±¬æ€§
                            return `
                                <tr>
                                    <td><img src="${imageUrl}" alt="${menu.MenuName}" height="100"></td>
                                    <td>${menu.MenuName}</td>
                                    <td>${menu.Price.toFixed(2)} å…ƒ</td>
                                    <td>
                                        <button class="toggle-details">æŸ¥çœ‹è©³ç´°</button>
                                        <button class="edit-menu-btn"
                                            data-id="${menu.MenuID || menu.id || ''}"
                                            data-name="${menu.MenuName}"
                                            data-price="${menu.Price}">
                                            ç·¨è¼¯
                                        </button>
                                        <div class="menu-details" style="display: none;">
                                            <h5>ä¸»è¦é£Ÿæ:</h5>
                                            <h5>è›‹ç™½è³ª</h5>
                                            <ul>${menu.ProteinChoices.map(choice => `<li>${choice}</li>`).join('')}</ul>
                                            <h5>ä½æ–™</h5>
                                            <ul>${menu.SideChoices.map(choice => `<li>${choice}</li>`).join('')}</ul>
                                            <h5>é†¬æ–™</h5>
                                            <ul>${menu.SauceChoices.map(choice => `<li>${choice}</li>`).join('')}</ul>
                                            <h5>ç‘æ–™</h5>
                                            <ul>${menu.SprinkleChoices.map(choice => `<li>${choice}</li>`).join('')}</ul>
                                        </div>
                                    </td>
                                </tr>
                            `;
                        }).join('')}
                    </tbody>
                </table>
            `;

            // è‡ªé¸é …ç›®è¡¨æ ¼ï¼ˆæ¸…æ™°åˆ†é¡ï¼‰
            menuList.innerHTML += `
                <table border="1" cellspacing="0" cellpadding="10">
                    <thead><tr><th colspan="2">è‡ªå·±é¸ (200å…ƒèµ·)</th></tr></thead>
                    <tbody>
                        <tr>
                            <th>åŸºåº• (å¿…é¸ä¸€å€‹)</th>
                            <td>${data.CustomOptions.BaseChoices.join('ã€')}</td>
                        </tr>
                        <tr>
                            <th>ä½æ–™ (æœ€å°‘1å€‹ï¼Œæœ€å¤š5å€‹)</th>
                            <td>${data.CustomOptions.SideChoices.join('ã€')}</td>
                        </tr>
                        <tr>
                            <th>è›‹ç™½è³ª (å¯é¸ä¸€ç¨®æˆ–ä¸é¸)</th>
                            <td>${data.CustomOptions.ProteinChoices.join('ã€')}</td>
                        </tr>
                        <tr>
                            <th>é†¬æ–™ (å¿…é¸ä¸€ç¨®)</th>
                            <td>${data.CustomOptions.SauceChoices.join('ã€')}</td>
                        </tr>
                        <tr>
                            <th>ç‘æ–™ (æœ€å¤šé¸å…©ç¨®)</th>
                            <td>${data.CustomOptions.SprinkleChoices.join('ã€')}</td>
                        </tr>
                    </tbody>
                </table>
            `;

            // é£²æ–™è¡¨æ ¼
            menuList.innerHTML += `
                <table border="1" cellspacing="0" cellpadding="10">
                    <thead><tr><th colspan="4">é£²æ–™</th></tr></thead>
                    <tbody>
                        ${data.Drinks.map(drink => `
                            <tr>
                                <td><img src="${drink.Image}" alt="${drink.DrinkName}" height="100"></td>
                                <td>${drink.DrinkName}</td>
                                <td>åƒ¹æ ¼: NT$ ${drink.DrinkPrice.toFixed(2)}</td>
                                <td>
                                    <button class="edit-drink-btn"
                                        data-id="${drink.DrinkID || drink.id || ''}"
                                        data-name="${drink.DrinkName}"
                                        data-price="${drink.DrinkPrice}">
                                        ç·¨è¼¯
                                    </button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;

            // é¡¯ç¤ºç”œåº¦èˆ‡å†°å¡Šé¸é …
            menuList.innerHTML += `
                <table border="1" cellspacing="0" cellpadding="10">
                    <thead><tr><th colspan="2">é£²æ–™é¸é …</th></tr></thead>
                    <tbody>
                        <tr>
                            <th>ç”œåº¦é¸æ“‡</th>
                            <td>${data.SweetnessOptions.join('ã€')}</td>
                        </tr>
                        <tr>
                            <th>å†°å¡Šé¸æ“‡</th>
                            <td>${data.IceOptions.join('ã€')}</td>
                        </tr>
                    </tbody>
                </table>
            `;


            // è©³ç´°è³‡æ–™çš„é¡¯ç¤ºèˆ‡éš±è—åŠŸèƒ½
            document.querySelectorAll('.toggle-details').forEach(button => {
                button.addEventListener('click', () => {
                    const details = button.nextElementSibling;
                    if (details.style.display === 'none') {
                        details.style.display = 'block';
                        button.textContent = 'æ”¶èµ·è©³ç´°';
                    } else {
                        details.style.display = 'none';
                        button.textContent = 'æŸ¥çœ‹è©³ç´°';
                    }
                });
            });

            // æ–°å¢ï¼šé»æ“Šã€Œç·¨è¼¯ã€è‡ªå‹•å¸¶å…¥æ¬„ä½
            document.querySelectorAll('.edit-menu-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.getElementById('update-menu-id').value = this.dataset.id;
                    document.getElementById('update-menu-name').value = this.dataset.name;
                    document.getElementById('update-menu-price').value = this.dataset.price;
                    // è‡ªå‹•åˆ‡æ›åˆ°ç·¨è¼¯å€å¡Š
                    showSection('menu-list');
                });
            });

            // é»æ“Šã€Œç·¨è¼¯ã€é£²æ–™è‡ªå‹•å¸¶å…¥æ¬„ä½
            document.querySelectorAll('.edit-drink-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.getElementById('update-drink-id').value = this.dataset.id;
                    document.getElementById('update-drink-name').value = this.dataset.name;
                    document.getElementById('update-drink-price').value = this.dataset.price;
                    showSection('menu-list');
                });
            });
        }

        // å°è£å–å¾—èˆ‡é¡¯ç¤ºèœå–®çš„å‡½å¼
        function fetchAndDisplayMenu() {
            fetch('http://localhost/ouo/get-menu-data.php')
                .then(response => response.json())
                .then(data => displayMenu(data))
                .catch(error => console.error('Error fetching menu data:', error));
        }

        // æœå°‹åŠŸèƒ½
        document.getElementById('search-button').addEventListener('click', () => {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();

            fetch('http://localhost/ouo/get-menu-data.php')
                .then(res => res.json())
                .then(data => {
                    const filteredMenu = {
                        SetMeals: data.SetMeals.filter(menu => menu.MenuName.toLowerCase().includes(searchTerm)),
                        CustomOptions: data.CustomOptions,
                        Drinks: data.Drinks
                    };
                    displayMenu(filteredMenu);
                })
                .catch(console.error);
        });

        // ä¿®æ”¹èœå–®é …ç›®åŠŸèƒ½ï¼ˆé€£æ¥ PHPï¼‰
        document.getElementById('update-button').addEventListener('click', () => {
            const id = parseInt(document.getElementById('update-menu-id').value);
            const name = document.getElementById('update-menu-name').value.trim();
            const price = parseFloat(document.getElementById('update-menu-price').value);

            if (isNaN(id) || !name || isNaN(price) || price <= 0) {
                alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„èœå–® IDã€åç¨±å’Œåƒ¹æ ¼ï¼');
                return;
            }

            fetch('http://localhost/ouo/update-menu.php', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ id, name, price })
            })
            .then(res => res.json())
            .then(result => {
                if (result.success) {
                    alert('èœå–®é …ç›®ä¿®æ”¹æˆåŠŸï¼');
                    fetchAndDisplayMenu(); // æˆåŠŸå¾Œé‡æ–°æŠ“è³‡æ–™
                } else {
                    alert('ä¿®æ”¹èœå–®é …ç›®å¤±æ•—ï¼š' + (result.error || 'æœªçŸ¥éŒ¯èª¤'));
                }
            })
            .catch(error => {
                console.error('ä¿®æ”¹éŒ¯èª¤:', error);
                alert('ä¿®æ”¹æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼');
            });
        });


        // åˆå§‹è¼‰å…¥èœå–®
        fetchAndDisplayMenu();


        //é€£æ¥phpçš„ç¯„ä¾‹
        /* fetch('manage1.php')
            .then(response => {
                if (!response.ok) {
                throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                // data åŒ…å«å¾ PHP API å›å‚³çš„ JSON è³‡æ–™
                console.log(data);
                // åœ¨é€™è£¡è™•ç† JSON è³‡æ–™ï¼Œä¾‹å¦‚æ›´æ–°ç¶²é å…§å®¹
            })
            .catch(error => {
                console.error('There has been a problem with your fetch operation:', error);
            }); */

        //åˆ‡æ›ä¸‹æ‹‰åˆ—è¡¨é¡¯ç¤º
        function toggleDropdown(id) {
            var dropdown = document.getElementById(id);
            var button = dropdown.previousElementSibling;

            if (dropdown.style.display === 'block') {
                dropdown.style.display = 'none';
                button.setAttribute('aria-expanded', 'false');
            } else {
                closeAllDropdowns();
                dropdown.style.display = 'block';
                button.setAttribute('aria-expanded', 'true');
            }
        }

        window.onclick = function (event) {
            if (!event.target.matches('button')) {
                const dropdowns = document.querySelectorAll('.dropdown-content');
                dropdowns.forEach(dropdown => {
                    dropdown.style.display = 'none';
                });
            }
        }

        //é—œé–‰æ‰€æœ‰ä¸‹æ‹‰åˆ—è¡¨
        function closeAllDropdowns() {
            var dropdowns = document.querySelectorAll('.dropdown-content');
            dropdowns.forEach(function (dropdown) {
                dropdown.style.display = 'none';
            });
            var buttons = document.querySelectorAll('.navbar button');
            buttons.forEach(function (button) {
                button.setAttribute('aria-expanded', 'false');
            });
        }

        //é¡¯ç¤ºç‰¹å®šéƒ¨åˆ†
        function showSection(sectionId) {
            var sections = document.querySelectorAll('.dashboard');
            sections.forEach(function (section) {
                section.classList.remove('active');
            });
            var section = document.getElementById(sectionId);
            if (section) {
                section.classList.add('active');
            }
        }

        function handleHashChange() {
            var sectionId = location.hash.substring(1);
            if (!sectionId) {
                sectionId = 'home';
            }
            showSection(sectionId);
        }

        document.addEventListener('click', function (event) {
            var isClickInside = event.target.closest('.dropdown') !== null;
            if (!isClickInside) {
                closeAllDropdowns();
            }
        });

        //åˆå§‹åŒ–å°èˆªéˆæ¥
        document.querySelectorAll('.navbar a').forEach(function (link) {
            link.addEventListener('click', function () {
                var target = this.getAttribute('href').substring(1);
                showSection(target);
            });
        });

        window.addEventListener('hashchange', handleHashChange);

        //åˆå§‹åŒ–å„€è¡¨æ¿
        document.addEventListener('DOMContentLoaded', function () {
            if (!location.hash) {
                location.hash = '#home';
            }
            handleHashChange();
            createChart('salesTrend', ['ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'æ—¥'], [15, 23, 8, 12, 5, 7, 11], 'éŠ·å”®é¡');
            createChart('inventoryLevels', ['ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'æ—¥'], [50, 45, 60, 55, 40, 42, 50], 'åº«å­˜');
        });

        //æœå°‹åŠŸèƒ½
        function filterTable() {
            const input = document.getElementById("search-input");
            const filter = input.value.toLowerCase();
            const tbody = document.getElementById("customer-tbody");
            const tr = tbody.getElementsByTagName("tr");

            for (let i = 0; i < tr.length; i++) {
                let tdArray = tr[i].getElementsByTagName("td");
                let display = false;
                for (let j = 0; j < tdArray.length; j++) {
                    let td = tdArray[j];
                    if (td) {
                        if (td.textContent.toLowerCase().indexOf(filter) > -1) {
                            display = true;
                            break;
                        }
                    }
                }
                tr[i].style.display = display ? "" : "none";
            }
        }
        //æ’åºè¡¨åŠŸèƒ½
        function sortTable(n) {
            let table = document.querySelector("table");
            let rows = table.rows;
            let switching = true;
            let shouldSwitch, i, x, y;
            let dir = "asc";
            let switchCount = 0;

            while (switching) {
                switching = false;
                let rowsArray = Array.from(rows).slice(1); // Exclude the header row
                for (i = 0; i < rowsArray.length - 1; i++) {
                    shouldSwitch = false;
                    x = rowsArray[i].getElementsByTagName("TD")[n];
                    y = rowsArray[i + 1].getElementsByTagName("TD")[n];
                    if (dir === "asc") {
                        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                            shouldSwitch = true;
                            break;
                        }
                    } else if (dir === "desc") {
                        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                            shouldSwitch = true;
                            break;
                        }
                    }
                }
                if (shouldSwitch) {
                    rowsArray[i].parentNode.insertBefore(rowsArray[i + 1], rowsArray[i]);
                    switching = true;
                    switchCount++;
                } else {
                    if (switchCount === 0 && dir === "asc") {
                        dir = "desc";
                        switching = true;
                    }
                }
            }
        }

        //å‰µå»ºåœ–è¡¨
        function createChart(canvasId, labels, data, label) {
            var ctx = document.getElementById(canvasId).getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: label,
                        data: data,
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        //66666 ä¿å­˜è¨­ç½®
        document.addEventListener('DOMContentLoaded', function () {
            // è®€å–å·²ä¿å­˜çš„è¨­ç½®
            if (localStorage.getItem('language')) {
                document.getElementById('language').value = localStorage.getItem('language');
            }
            if (localStorage.getItem('timezone')) {
                document.getElementById('timezone').value = localStorage.getItem('timezone');
            }
            if (localStorage.getItem('currency')) {
                document.getElementById('currency').value = localStorage.getItem('currency');
            }

            // æ·»åŠ é»æ“Šäº‹ä»¶è™•ç†ç¨‹åº
            document.getElementById('save-settings-btn').addEventListener('click', function (event) {
                event.preventDefault(); // é˜»æ­¢æŒ‰éˆ•çš„é»˜èªè¡Œç‚º

                let language = document.getElementById('language').value;
                let timezone = document.getElementById('timezone').value;
                let currency = document.getElementById('currency').value;

                // ä¿å­˜è¨­ç½®åˆ° localStorage
                localStorage.setItem('language', language);
                localStorage.setItem('timezone', timezone);
                localStorage.setItem('currency', currency);

                console.log('èªè¨€:', language);
                console.log('æ™‚å€:', timezone);
                console.log('è²¨å¹£å–®ä½:', currency);

                alert('è¨­ç½®å·²ä¿å­˜ï¼'); // æäº¤è¡¨å–®å¾Œé¡¯ç¤ºæç¤ºæ¡†
            });
        });

        // ====== è‡ªå‹•ç™»å‡ºåŠŸèƒ½ï¼ˆé–’ç½®10åˆ†é˜è‡ªå‹•è·³è½‰ï¼‰======
        let logoutTimer;
        function resetLogoutTimer() {
            clearTimeout(logoutTimer);
            logoutTimer = setTimeout(() => {
                alert('æ‚¨å·²é–’ç½®éä¹…ï¼Œç³»çµ±å°‡è‡ªå‹•ç™»å‡ºã€‚');
                window.location.href = 'logout.php';
            }, 10 * 60 * 1000); // 10åˆ†é˜
        }
        ['click','mousemove','keydown','scroll','touchstart'].forEach(evt =>
            document.addEventListener(evt, resetLogoutTimer)
        );
        resetLogoutTimer();
        // ====== è‡ªå‹•ç™»å‡ºåŠŸèƒ½çµæŸ ======

    </script>

    <script src="dashboard.js"></script>

</body>

</html>